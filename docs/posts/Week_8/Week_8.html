<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kailyn Hogan">
<meta name="dcterms.date" content="2023-07-07">

<title>Kailyn Hogan’s DSPG Blog - Week Eight of Data Science for the Public Good</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Kailyn Hogan’s DSPG Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kailynhogan" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/kailynjhogan/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Week Eight of Data Science for the Public Good</h1>
            <p class="subtitle lead">It is hustle time!</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Week Eight</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">Demographic Analysis</div>
                <div class="quarto-category">Demographic Profile</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kailyn Hogan </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 7, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="demographic-profile" class="level2">
<h2 class="anchored" data-anchor-id="demographic-profile">Demographic Profile</h2>
<p>I began editing the Demographic Profile I made two weeks ago this week. I went back and added comments to my code, added regional and national context to the plots, and started converting some of the data into percentages. Below is the work I completed.</p>
<section id="population-plots" class="level3">
<h3 class="anchored" data-anchor-id="population-plots">Population Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidycensus)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">### The first thing we want to visualize is population change.</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Population Change                                                          </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the variables before getting the data.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># The Census API code for total population for 2000 and 2010 is P001001.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>pop00 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pop"</span> <span class="ot">=</span> <span class="st">"P001001"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>pop10 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pop"</span> <span class="ot">=</span> <span class="st">"P001001"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># The API code for total population changed for 2020.</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># The Census API code for total population is P1_001N for 2020. </span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>pop20 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pop"</span> <span class="ot">=</span> <span class="st">"P1_001N"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="do">## National Context: nationPop</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting 2000 total population data for the USA.</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>nation00 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"us"</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">year =</span> <span class="dv">2000</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variable =</span> pop00,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2000</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting 2010 total population data for the USA.</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>nation10 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"us"</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">year =</span> <span class="dv">2010</span>,</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variable =</span> pop10,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2010</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting 2020 total population data for the USA.</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>nation20 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"us"</span>,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                          <span class="at">year =</span> <span class="dv">2020</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variable =</span> pop20,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2020</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind the years together using bind_rows to create data frame for national context. </span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>nationPop <span class="ot">&lt;-</span> nation20 <span class="sc">%&gt;%</span> </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(nation10,nation00) <span class="sc">%&gt;%</span> </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"Nation"</span>) </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="do">## Regional Context: regionPop</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting 2000 total population data from the Midwest.</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>region00 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"region"</span>,</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>                          <span class="at">year =</span> <span class="dv">2000</span>,</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variable =</span> pop00,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                          <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2000</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting 2010 total population data for the Midwest.</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>region10 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"region"</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>                          <span class="at">year =</span> <span class="dv">2010</span>,</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variable =</span> pop10,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>                          <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2010</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting 2020 total population data for the Midwest.</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>region20 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"region"</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>                          <span class="at">year =</span> <span class="dv">2020</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variable =</span> pop20,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>                          <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2020</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind the years together using bind_rows to create data frame for regional context. </span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to keep just the Midwest Region. </span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>regionPop <span class="ot">&lt;-</span> region20 <span class="sc">%&gt;%</span> </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(region10,region00) <span class="sc">%&gt;%</span> </span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">==</span> <span class="st">"Midwest Region"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" Region"</span>)) <span class="sc">%&gt;%</span> <span class="co"># Use str_remove() to remove " Region" from Midwest. </span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"Region"</span>)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="do">## State Context: statePop</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the 2000 total population data for the state of Iowa from the Decennial Census.</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>iowa00 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"state"</span>,</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>                        <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>                        <span class="at">year =</span> <span class="dv">2000</span>,</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>                        <span class="at">output =</span> <span class="st">"wide"</span>,</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable =</span> pop00) <span class="sc">%&gt;%</span> </span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2000</span>)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the 2010 total population data for the state of Iowa from the Decennial Census.</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>iowa10 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"state"</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>                        <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable =</span> pop10,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>                        <span class="at">year =</span> <span class="dv">2010</span>,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>                        <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2010</span>)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the 2020 total population data for the state of Iowa from the Decennial Census.</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>iowa20 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"state"</span>,</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>                        <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable =</span> pop20,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>                        <span class="at">year =</span> <span class="dv">2020</span>,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>                        <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2020</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind the years together using bind_rows to create data frame for state context. </span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>statePop <span class="ot">&lt;-</span> iowa20 <span class="sc">%&gt;%</span> </span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(iowa10,iowa00) <span class="sc">%&gt;%</span> </span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"State"</span>)</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a><span class="do">## Places: </span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting 2000 total population data for all places in Iowa.</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>place00 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>                         <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>                         <span class="at">year =</span> <span class="dv">2000</span>,</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>                         <span class="at">output =</span> <span class="st">"wide"</span>,</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>                         <span class="at">variables =</span> pop00) <span class="sc">%&gt;%</span> </span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2000</span>)</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>place10 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>                         <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>                         <span class="at">year =</span> <span class="dv">2010</span>,</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>                         <span class="at">output =</span> <span class="st">"wide"</span>,</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>                         <span class="at">variables =</span> pop10) <span class="sc">%&gt;%</span> </span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2010</span>)</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>place20 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>                         <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>                         <span class="at">variable =</span> pop20,</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>                         <span class="at">year =</span> <span class="dv">2020</span>,</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>                         <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2020</span>)</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind the years together using bind_rows() to create data frame for all places in Iowa. </span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>placePop <span class="ot">&lt;-</span> place20 <span class="sc">%&gt;%</span> </span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(place10,place00) <span class="sc">%&gt;%</span> </span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"Place"</span>)</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Independence, Grundy Center, and New Hampton. </span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>placePop <span class="ot">&lt;-</span> placePop[placePop<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center city, Iowa"</span>, <span class="st">"Independence city, Iowa"</span>, <span class="st">"New Hampton city, Iowa"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa|, Iowa"</span>)) <span class="co"># Use str_remove() to remove "city, Iowa" from behind the place names. </span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine nationPop, regionPop, statePop, and placePop using bind_rows().</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> nationPop <span class="sc">%&gt;%</span> </span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(regionPop,statePop,placePop)</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the change in population.</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> population <span class="sc">%&gt;%</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NAME) <span class="sc">%&gt;%</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pop_change =</span> pop <span class="sc">-</span> <span class="fu">lag</span>(pop)) </span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a><span class="co"># Start visualizing total population now that master data frame is created. </span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the change in total population for Independence.                           PLOT</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter population for Independence.</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>population <span class="sc">%&gt;%</span> </span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">==</span> <span class="st">"Independence"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pop))<span class="sc">+</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">comma</span>(pop)), <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">31</span>)<span class="sc">+</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma)<span class="sc">+</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1997</span>, <span class="dv">2023</span>),</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">2010</span>,<span class="dv">2020</span>))<span class="sc">+</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Total Population"</span>,</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Independence, Iowa"</span>,</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Population"</span>,</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>, </span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"2000-2020 Decennial Census"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week_8_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the change in total population for New Hampton.                           PLOT</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter population for New Hampton.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>population <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">==</span> <span class="st">"New Hampton"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pop))<span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">comma</span>(pop)),<span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">3</span>)<span class="sc">+</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma)<span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1997</span>, <span class="dv">2023</span>),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">2010</span>,<span class="dv">2020</span>))<span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Total Population"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"New Hampton, Iowa"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Population"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>, </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"2000-2020 Decennial Census"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week_8_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the change in total population Grundy Center.                              PLOT</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter population for Grundy Center.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>population <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">==</span> <span class="st">"Grundy Center"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pop))<span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">comma</span>(pop)),<span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma)<span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1997</span>, <span class="dv">2023</span>),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">2010</span>,<span class="dv">2020</span>))<span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Total Population"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Grundy Center, Iowa"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Population"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>, </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"2000-2020 Decennial Census"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week_8_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot total population for all cities.                                           PLOT    </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for the cities. </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign the plot to an object.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>population[population<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center"</span>, <span class="st">"Independence"</span>, <span class="st">"New Hampton"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pop, <span class="at">group =</span> NAME))<span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> NAME), <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">comma</span>(pop_change)),<span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2500</span>,<span class="dv">6300</span>))<span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1998</span>, <span class="dv">2022</span>),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">2010</span>,<span class="dv">2020</span>))<span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Total Population"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2000-2020 Decennial Census"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Population"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>, </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Variables: P1_001N and P001001"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week_8_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot change in total population with line type = NAME.                           PLOT</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>population[population<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center"</span>, <span class="st">"Independence"</span>, <span class="st">"New Hampton"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pop, <span class="at">group =</span> NAME, <span class="at">linetype =</span> NAME))<span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">comma</span>(pop)),<span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)<span class="sc">+</span>  </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2500</span>,<span class="dv">6500</span>))<span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1998</span>, <span class="dv">2022</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">2010</span>,<span class="dv">2020</span>))<span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Total Population"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Comparison between Grundy Center, Independence,</span><span class="sc">\n</span><span class="st">and New Hampton"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Population"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>, </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"2000-2020 Decennial Census"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week_8_files/figure-html/unnamed-chunk-2-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot total population for all geographies.                                      PLOT</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign the plot to an object.</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>population <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pop, <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> geography, <span class="at">color =</span> NAME), <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2020</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">2010</span>,<span class="dv">2020</span>))<span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Total Population"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Population (log scale)"</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2000-2020 Decennial Census"</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>, </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Variables: P1_001N and P001001"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week_8_files/figure-html/unnamed-chunk-2-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The next thing we want to visualize is the PERCENT CHANGE in population.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Percent Population Change                                                  </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create anew column called prc_change.</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by "NAME" so that the calculations occur individually for each place. </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent change is calculated by subtracting year2 from year1 and dividing by year2. </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> population <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NAME) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prc_change =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    year <span class="sc">==</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    year <span class="sc">==</span> <span class="dv">2010</span> <span class="sc">~</span> (pop <span class="sc">-</span> <span class="fu">lag</span>(pop, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">default =</span> <span class="fu">last</span>(pop))) <span class="sc">/</span> <span class="fu">lag</span>(pop, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">default =</span> <span class="fu">last</span>(pop)),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    year <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">~</span> (pop <span class="sc">-</span> <span class="fu">lag</span>(pop, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">default =</span> <span class="fu">last</span>(pop))) <span class="sc">/</span> <span class="fu">lag</span>(pop, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">default =</span> <span class="fu">last</span>(pop))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a grouping column in the population data</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> population <span class="sc">%&gt;%</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grouping =</span> <span class="fu">ifelse</span>(NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"Midwest"</span>, <span class="st">"Iowa"</span>), <span class="st">"Contextual Area"</span>, <span class="st">"Places"</span>))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot the percent change in population for all geographies.                    PLOT</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign the plot to an object.</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>population <span class="sc">%&gt;%</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> prc_change, <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> NAME, <span class="at">linetype =</span> grouping), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span> <span class="fl">2020.65</span>, <span class="at">y =</span> .<span class="dv">1777</span>, <span class="at">label =</span> <span class="st">"17.77%"</span>), <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span> <span class="fl">2020.65</span>, <span class="at">y =</span> .<span class="dv">09023</span>, <span class="at">label =</span> <span class="st">"9.02%"</span>), <span class="at">vjust =</span> <span class="sc">-</span>.<span class="dv">2</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span> <span class="fl">2020.65</span>, <span class="at">y =</span> .<span class="dv">07132</span>, <span class="at">label =</span> <span class="st">"7.13%"</span>), <span class="at">vjust =</span> <span class="fl">1.2</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span> <span class="fl">2020.65</span>, <span class="at">y =</span> .<span class="dv">0770416</span>, <span class="at">label =</span> <span class="st">"7.70%"</span>), <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">vjust =</span> <span class="sc">-</span>.<span class="dv">000002</span>) <span class="sc">+</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span> <span class="fl">2020.65</span>, <span class="at">y =</span> .<span class="dv">0083139</span>, <span class="at">label =</span> <span class="st">"0.83%"</span>), <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span> <span class="fl">2020.65</span>, <span class="at">y =</span> <span class="sc">-</span>.<span class="dv">053629</span>, <span class="at">label =</span> <span class="st">"-5.36%"</span>), <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2010</span>, <span class="dv">2015</span>,<span class="dv">2020</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2010</span>,<span class="dv">2021</span>)) <span class="sc">+</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percent Change in Total Population"</span>,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2000-2020 Decennial Census"</span>,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Variables: P1_001N and P001001"</span>,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week_8_files/figure-html/unnamed-chunk-2-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot the percent change in total population for just the places.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the population data frame for places. </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign the plot to an object.</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>population[population<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center"</span>, <span class="st">"Independence"</span>, <span class="st">"New Hampton"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> prc_change, <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> NAME), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prc_change)), <span class="at">hjust =</span> .<span class="dv">5</span>,<span class="at">vjust =</span> <span class="sc">-</span>.<span class="dv">75</span> )<span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">06</span>,.<span class="dv">085</span>)) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2010</span>,<span class="dv">2015</span>, <span class="dv">2020</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2008</span>, <span class="dv">2022</span>)) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span>  <span class="co"># Align legend to the right</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percent Change in Total Population"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2000-2020 Decennial Census"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Variables: P1_001N and P001001"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week_8_files/figure-html/unnamed-chunk-2-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, we want to visualize the population estimates. </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># In this case, we will be estimated the 2030 population.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Population Estimates                                                       </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate AAAC for each geography.</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># AAAC = 2020 population - 2000 population / 20</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># AKA. AAAC = population - population / time</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> population <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NAME) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AAAC =</span> (pop[year <span class="sc">==</span> <span class="dv">2020</span>] <span class="sc">-</span> pop[year <span class="sc">==</span> <span class="dv">2000</span>]) <span class="sc">/</span> <span class="dv">20</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame for the projected population in 2030.</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>proj_2030 <span class="ot">&lt;-</span> population <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2030</span>, <span class="at">pop =</span> pop <span class="sc">+</span> (AAAC<span class="sc">*</span><span class="dv">10</span>))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the original data frame and the projected population data for 2030.</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(population, proj_2030)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the AAAC column.</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> population <span class="sc">%&gt;%</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>AAAC)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column specifying if the population is actual or a projection.</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> population <span class="sc">%&gt;%</span> </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">if_else</span>(year <span class="sc">==</span> <span class="dv">2030</span>, <span class="st">"Projection"</span>, <span class="st">"Actual"</span>))</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the actual and projected total population from 2000 to 2030               PLOT </span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>population[population<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center"</span>, <span class="st">"Independence"</span>, <span class="st">"New Hampton"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pop, <span class="at">group =</span> NAME, <span class="at">linetype =</span> NAME)) <span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> type), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">round</span>(pop))),</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2500</span>,<span class="dv">6500</span>))<span class="sc">+</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1998</span>,<span class="dv">2032</span>),</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"2000"</span>,<span class="st">"2010"</span>,<span class="st">"2020"</span>, <span class="st">"2030 Est."</span>))<span class="sc">+</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Total Population"</span>,</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"2030 Population Estimated with AAAC</span><span class="sc">\n</span><span class="st">Variables: P1_001N and P001001"</span>,</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2000-2020 Decennial Census"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week_8_files/figure-html/unnamed-chunk-2-9.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="median-income-plots" class="level3">
<h3 class="anchored" data-anchor-id="median-income-plots">Median Income Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Median Income</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting median income data from the 5-Year American Community Survey. </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The median income variable is "B19013_001."</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an object called "years" that lists the years you want to pull data from. </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We want all of the years the ACS data is available. </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">2009</span><span class="sc">:</span><span class="dv">2021</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(years) <span class="ot">&lt;-</span> years</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Use get_acs() to pull median income data at the place level.</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>placeIncome <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"median_income"</span> <span class="ot">=</span> <span class="st">"B19013_001"</span>),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the " city, Iowa|, Iowa" from the end of the place names.</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>placeIncome <span class="ot">&lt;-</span> placeIncome <span class="sc">%&gt;%</span> </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa|, Iowa"</span>))</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter placeIncome for desired cities.</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a geography column.</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>placeIncome <span class="ot">&lt;-</span> placeIncome <span class="sc">%&gt;%</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center"</span>, <span class="st">"Independence"</span>, <span class="st">"New Hampton"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"Place"</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Use get_acs() to pull median income data at the state level.</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>stateIncome <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"state"</span>,</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"median_income"</span> <span class="ot">=</span> <span class="st">"B19013_001"</span>),</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a geography column. </span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>stateIncome <span class="ot">&lt;-</span> stateIncome <span class="sc">%&gt;%</span> </span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"State"</span>)</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Use get_acs() to pull median income data at the regional level.</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>regionIncome <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"region"</span>,</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"median_income"</span> <span class="ot">=</span> <span class="st">"B19013_001"</span>),</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) </span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the " Region" from the end of the region names.</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>regionIncome <span class="ot">&lt;-</span> regionIncome <span class="sc">%&gt;%</span> </span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" Region"</span>))</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter regionIncome for Midwest.</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a geography column.</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>regionIncome <span class="ot">&lt;-</span> regionIncome <span class="sc">%&gt;%</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">%in%</span> <span class="st">"Midwest"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"Region"</span>)</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Use get_acs() to pull median income data at the national level.</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>nationIncome <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"us"</span>,</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"median_income"</span> <span class="ot">=</span> <span class="st">"B19013_001"</span>),</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>)</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a geography column.</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>nationIncome <span class="ot">&lt;-</span> nationIncome <span class="sc">%&gt;%</span> </span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"Nation"</span>)</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind all geographies together with bind_rows().</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> nationIncome <span class="sc">%&gt;%</span> </span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(regionIncome, stateIncome, placeIncome)</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column specifying if the geography is a nation, region, state, or place. </span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> income <span class="sc">%&gt;%</span> </span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grouping =</span> <span class="fu">ifelse</span>(NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"Midwest"</span>, <span class="st">"Iowa"</span>), <span class="st">"Contextual Area"</span>, NAME))</span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Create three separate plots for Grundy Center, Independence and New Hampton.</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots together using patchwork library. </span></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("patchwork")</span></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the median income for Grundy Center and its contextual geographies.       PLOT</span></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> income[income<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center"</span>, <span class="st">"United States"</span>, <span class="st">"Midwest"</span>, <span class="st">"Iowa"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> median_incomeE, <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> median_incomeE <span class="sc">+</span> median_incomeM, <span class="at">ymin =</span> median_incomeE <span class="sc">-</span> median_incomeM, <span class="at">fill =</span> geography),</span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> geography), <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> .<span class="dv">001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>),</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">32250</span>,<span class="dv">80000</span>))<span class="sc">+</span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2009-2021 5-Year ACS Estimates</span><span class="sc">\n</span><span class="st">Grundy Center"</span>,</span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Median Income"</span>) </span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the median income for Independence and its contextual geographies.        PLOT </span></span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> income[income<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Independence"</span>, <span class="st">"United States"</span>, <span class="st">"Midwest"</span>, <span class="st">"Iowa"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> median_incomeE, <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> median_incomeE <span class="sc">+</span> median_incomeM, <span class="at">ymin =</span> median_incomeE <span class="sc">-</span> median_incomeM, <span class="at">fill =</span> geography),</span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> geography), <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> .<span class="dv">001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>),</span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">32250</span>,<span class="dv">80000</span>))<span class="sc">+</span></span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">Independence"</span>,</span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>)</span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the median income for New Hampton and its contextual geographies.         PLOT </span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> income[income<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"New Hampton"</span>, <span class="st">"United States"</span>, <span class="st">"Midwest"</span>, <span class="st">"Iowa"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> median_incomeE, <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> median_incomeE <span class="sc">+</span> median_incomeM, <span class="at">ymin =</span> median_incomeE <span class="sc">-</span> median_incomeM, <span class="at">fill =</span> geography),</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> geography), <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> .<span class="dv">001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>),</span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">32250</span>,<span class="dv">80000</span>))<span class="sc">+</span></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">New Hampton"</span>,</span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Shaded area represents margin of error around the ACS estimate</span><span class="sc">\n</span><span class="st">Variable: B19013_001"</span>)</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots. </span></span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a>combined_plots <span class="ot">&lt;-</span> <span class="fu">wrap_plots</span>(plot1, plot2, plot3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="median-year-built-and-median-value-by-year-built-plots" class="level3">
<h3 class="anchored" data-anchor-id="median-year-built-and-median-value-by-year-built-plots">Median Year Built and Median Value by Year Built Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># House Age                                                               </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Want to plot Year Built data as percentages to standardize that data over different geography sizes.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Year Built data and Total Structure data from 2021 5-year American Community Survey (ACS) for all places in Iowa.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>placeAge <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"place"</span>, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"IA"</span>, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"2020 or later"</span> <span class="ot">=</span> <span class="st">"B25034_002"</span>, </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2010 to 2019"</span> <span class="ot">=</span> <span class="st">"B25034_003"</span>, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2000 to 2009"</span> <span class="ot">=</span> <span class="st">"B25034_004"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1990 to 1999"</span> <span class="ot">=</span> <span class="st">"B25034_005"</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1980 to 1989"</span> <span class="ot">=</span> <span class="st">"B25034_006"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1970 to 1979"</span> <span class="ot">=</span> <span class="st">"B25034_007"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1960 to 1969"</span> <span class="ot">=</span> <span class="st">"B25034_008"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1950 to 1959"</span> <span class="ot">=</span> <span class="st">"B25034_009"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1940 to 1949"</span> <span class="ot">=</span> <span class="st">"B25034_010"</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1939 or earlier"</span> <span class="ot">=</span> <span class="st">"B25034_011"</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">"total"</span> <span class="ot">=</span> <span class="st">"B25034_001"</span>), </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2021</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for desired cities. </span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>placeAge <span class="ot">&lt;-</span> placeAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center city, Iowa"</span>, <span class="st">"Independence city, Iowa"</span>, <span class="st">"New Hampton city, Iowa"</span>))</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove " city, Iowa" using str_remove().</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>placeAge <span class="ot">&lt;-</span> placeAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">"city, Iowa"</span>))</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Group the house age data frame by NAME and calculate the percent by dividing the estimate value by the total value. </span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>placeAge <span class="ot">&lt;-</span> placeAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NAME) <span class="sc">%&gt;%</span> </span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> estimate<span class="sc">/</span> <span class="fu">first</span>(estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">"total"</span>) <span class="co"># Removes rows containing the total.</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Year Built data and Total Structure data from 2021 5-year American Community Survey (ACS) for Iowa.</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>stateAge <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"state"</span>, </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"IA"</span>, </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"2020 or later"</span> <span class="ot">=</span> <span class="st">"B25034_002"</span>, </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2010 to 2019"</span> <span class="ot">=</span> <span class="st">"B25034_003"</span>, </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2000 to 2009"</span> <span class="ot">=</span> <span class="st">"B25034_004"</span>,</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1990 to 1999"</span> <span class="ot">=</span> <span class="st">"B25034_005"</span>,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1980 to 1989"</span> <span class="ot">=</span> <span class="st">"B25034_006"</span>,</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1970 to 1979"</span> <span class="ot">=</span> <span class="st">"B25034_007"</span>,</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1960 to 1969"</span> <span class="ot">=</span> <span class="st">"B25034_008"</span>,</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1950 to 1959"</span> <span class="ot">=</span> <span class="st">"B25034_009"</span>,</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1940 to 1949"</span> <span class="ot">=</span> <span class="st">"B25034_010"</span>,</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1939 or earlier"</span> <span class="ot">=</span> <span class="st">"B25034_011"</span>,</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">"total"</span> <span class="ot">=</span> <span class="st">"B25034_001"</span>), </span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2021</span>)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percent by dividing the estimate value by the total value. </span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>stateAge <span class="ot">&lt;-</span> stateAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> estimate<span class="sc">/</span> <span class="fu">first</span>(estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">"total"</span>) <span class="co"># Removes rows containing the total.</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Year Built data and Total Structure data from 2021 5-year American Community Survey (ACS) for the Midwest.</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>regionAge <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"region"</span>, </span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"2020 or later"</span> <span class="ot">=</span> <span class="st">"B25034_002"</span>, </span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2010 to 2019"</span> <span class="ot">=</span> <span class="st">"B25034_003"</span>, </span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2000 to 2009"</span> <span class="ot">=</span> <span class="st">"B25034_004"</span>,</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1990 to 1999"</span> <span class="ot">=</span> <span class="st">"B25034_005"</span>,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1980 to 1989"</span> <span class="ot">=</span> <span class="st">"B25034_006"</span>,</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1970 to 1979"</span> <span class="ot">=</span> <span class="st">"B25034_007"</span>,</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1960 to 1969"</span> <span class="ot">=</span> <span class="st">"B25034_008"</span>,</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1950 to 1959"</span> <span class="ot">=</span> <span class="st">"B25034_009"</span>,</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1940 to 1949"</span> <span class="ot">=</span> <span class="st">"B25034_010"</span>,</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1939 or earlier"</span> <span class="ot">=</span> <span class="st">"B25034_011"</span>,</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>                <span class="st">"total"</span> <span class="ot">=</span> <span class="st">"B25034_001"</span>), </span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2021</span>)</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for desired cities. </span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>regionAge <span class="ot">&lt;-</span> regionAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">==</span> <span class="st">"Midwest Region"</span>)</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove " city, Iowa" using str_remove().</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>regionAge <span class="ot">&lt;-</span> regionAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" Region"</span>))</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Group the house age data frame by NAME and calculate the percent by dividing the estimate value by the total value. </span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>regionAge <span class="ot">&lt;-</span> regionAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> estimate<span class="sc">/</span> <span class="fu">first</span>(estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">"total"</span>) <span class="co"># Removes rows containing the total.</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Year Built data and Total Structure data from 2021 5-year American Community Survey (ACS) for the United States.</span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>nationAge <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"us"</span>, </span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"2020 or later"</span> <span class="ot">=</span> <span class="st">"B25034_002"</span>, </span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2010 to 2019"</span> <span class="ot">=</span> <span class="st">"B25034_003"</span>, </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2000 to 2009"</span> <span class="ot">=</span> <span class="st">"B25034_004"</span>,</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1990 to 1999"</span> <span class="ot">=</span> <span class="st">"B25034_005"</span>,</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1980 to 1989"</span> <span class="ot">=</span> <span class="st">"B25034_006"</span>,</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1970 to 1979"</span> <span class="ot">=</span> <span class="st">"B25034_007"</span>,</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1960 to 1969"</span> <span class="ot">=</span> <span class="st">"B25034_008"</span>,</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1950 to 1959"</span> <span class="ot">=</span> <span class="st">"B25034_009"</span>,</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1940 to 1949"</span> <span class="ot">=</span> <span class="st">"B25034_010"</span>,</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1939 or earlier"</span> <span class="ot">=</span> <span class="st">"B25034_011"</span>,</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>                <span class="st">"total"</span> <span class="ot">=</span> <span class="st">"B25034_001"</span>), </span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2021</span>)</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percent by dividing the estimate value by the total value. </span></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>nationAge <span class="ot">&lt;-</span> nationAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> estimate<span class="sc">/</span> <span class="fu">first</span>(estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">"total"</span>) <span class="co"># Removes rows containing the total.</span></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind contextual data together using bind_rows().</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>contextAge <span class="ot">&lt;-</span> stateAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(regionAge, nationAge)</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Year Built data.                                                      PLOT</span></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by name. Set geom_col() position to dodge to get the data displayed side by side. </span></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>house_age <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> contextAge, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> percent, <span class="at">group =</span> NAME, <span class="at">linetype =</span> NAME), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">data =</span> placeAge, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> percent, <span class="at">group =</span> NAME, <span class="at">fill =</span> NAME), <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Year Structure Built"</span>,</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2017-2021 5-Year ACS Estimates"</span>,</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ACS estimate"</span>,</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  caption = "Variables: B25034_002, B25034_003, B25034_004, B25034_005, B25034_006,\nB25034_007, B25034_008, B25034_009,B25034_010, B25034_011, B25034_001")+</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Median Home Value by Year Structure Built                                </span></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data from 2021 5-year American Community Survey for all places in Iowa.</span></span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>placeValueAge <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"place"</span>, </span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"IA"</span>, </span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"2020 or later"</span> <span class="ot">=</span> <span class="st">"B25107_002"</span>, </span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2010 to 2019"</span> <span class="ot">=</span> <span class="st">"B25107_003"</span>, </span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2000 to 2009"</span> <span class="ot">=</span> <span class="st">"B25107_004"</span>,</span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1990 to 1999"</span> <span class="ot">=</span> <span class="st">"B25107_005"</span>,</span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1980 to 1989"</span> <span class="ot">=</span> <span class="st">"B25107_006"</span>,</span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1970 to 1979"</span> <span class="ot">=</span> <span class="st">"B25107_007"</span>,</span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1960 to 1969"</span> <span class="ot">=</span> <span class="st">"B25107_008"</span>,</span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1950 to 1959"</span> <span class="ot">=</span> <span class="st">"B25107_009"</span>,</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1940 to 1949"</span> <span class="ot">=</span> <span class="st">"B25107_010"</span>,</span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1939 or earlier"</span> <span class="ot">=</span> <span class="st">"B25107_011"</span>), </span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2021</span>)</span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for desired cities. </span></span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>placeValueAge <span class="ot">&lt;-</span> placeValueAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center city, Iowa"</span>, <span class="st">"Independence city, Iowa"</span>, <span class="st">"New Hampton city, Iowa"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa"</span>))</span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data from 2021 5-year American Community Survey for Iowa.</span></span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>stateValueAge <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"state"</span>, </span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"IA"</span>, </span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"2020 or later"</span> <span class="ot">=</span> <span class="st">"B25107_002"</span>, </span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2010 to 2019"</span> <span class="ot">=</span> <span class="st">"B25107_003"</span>, </span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2000 to 2009"</span> <span class="ot">=</span> <span class="st">"B25107_004"</span>,</span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1990 to 1999"</span> <span class="ot">=</span> <span class="st">"B25107_005"</span>,</span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1980 to 1989"</span> <span class="ot">=</span> <span class="st">"B25107_006"</span>,</span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1970 to 1979"</span> <span class="ot">=</span> <span class="st">"B25107_007"</span>,</span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1960 to 1969"</span> <span class="ot">=</span> <span class="st">"B25107_008"</span>,</span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1950 to 1959"</span> <span class="ot">=</span> <span class="st">"B25107_009"</span>,</span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1940 to 1949"</span> <span class="ot">=</span> <span class="st">"B25107_010"</span>,</span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1939 or earlier"</span> <span class="ot">=</span> <span class="st">"B25107_011"</span>), </span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2021</span>)</span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data from 2021 5-year American Community Survey for the Midwest.</span></span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>regionValueAge <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"region"</span>, </span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"2020 or later"</span> <span class="ot">=</span> <span class="st">"B25107_002"</span>, </span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2010 to 2019"</span> <span class="ot">=</span> <span class="st">"B25107_003"</span>, </span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2000 to 2009"</span> <span class="ot">=</span> <span class="st">"B25107_004"</span>,</span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1990 to 1999"</span> <span class="ot">=</span> <span class="st">"B25107_005"</span>,</span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1980 to 1989"</span> <span class="ot">=</span> <span class="st">"B25107_006"</span>,</span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1970 to 1979"</span> <span class="ot">=</span> <span class="st">"B25107_007"</span>,</span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1960 to 1969"</span> <span class="ot">=</span> <span class="st">"B25107_008"</span>,</span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1950 to 1959"</span> <span class="ot">=</span> <span class="st">"B25107_009"</span>,</span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1940 to 1949"</span> <span class="ot">=</span> <span class="st">"B25107_010"</span>,</span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1939 or earlier"</span> <span class="ot">=</span> <span class="st">"B25107_011"</span>), </span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2021</span>)</span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for the Midwest. </span></span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a>regionValueAge <span class="ot">&lt;-</span> regionValueAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">==</span> <span class="st">"Midwest Region"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" Region"</span>))</span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data from 2021 5-year American Community Survey for the United States.</span></span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>nationValueAge <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"us"</span>, </span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"2020 or later"</span> <span class="ot">=</span> <span class="st">"B25107_002"</span>, </span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2010 to 2019"</span> <span class="ot">=</span> <span class="st">"B25107_003"</span>, </span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a>                <span class="st">"2000 to 2009"</span> <span class="ot">=</span> <span class="st">"B25107_004"</span>,</span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1990 to 1999"</span> <span class="ot">=</span> <span class="st">"B25107_005"</span>,</span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1980 to 1989"</span> <span class="ot">=</span> <span class="st">"B25107_006"</span>,</span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1970 to 1979"</span> <span class="ot">=</span> <span class="st">"B25107_007"</span>,</span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1960 to 1969"</span> <span class="ot">=</span> <span class="st">"B25107_008"</span>,</span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1950 to 1959"</span> <span class="ot">=</span> <span class="st">"B25107_009"</span>,</span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1940 to 1949"</span> <span class="ot">=</span> <span class="st">"B25107_010"</span>,</span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a>                <span class="st">"1939 or earlier"</span> <span class="ot">=</span> <span class="st">"B25107_011"</span>), </span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2021</span>)</span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a><span class="co"># Join all geographies.</span></span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a>contextValueAge <span class="ot">&lt;-</span> stateValueAge <span class="sc">%&gt;%</span> </span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(regionValueAge, nationValueAge)</span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a><span class="co"># plot median home value by year structure built                                  PLOT</span></span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a>house_value_by_year <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> contextValueAge, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> estimate, <span class="at">group =</span> NAME, <span class="at">linetype =</span> NAME), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">data =</span> placeValueAge, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> estimate, <span class="at">group =</span> NAME, <span class="at">fill =</span> NAME), <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span></span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Median Home Value by Year Structure Built"</span>,</span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2017-2021 5-Year ACS Estimates"</span>,</span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ACS estimate"</span>,</span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Variables: B25034_002, B25034_003, B25034_004, B25034_005, B25034_006,</span><span class="sc">\n</span><span class="st">B25034_007, B25034_008, B25034_009,B25034_010, B25034_011, B25034_001"</span>) <span class="sc">+</span></span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a><span class="co">#Use patchwork library to parse together year built and median value by year built plots.</span></span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a>value_and_year_built <span class="ot">&lt;-</span> house_age <span class="sc">+</span>house_value_by_year <span class="sc">+</span></span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="median-house-value-plots" class="level3">
<h3 class="anchored" data-anchor-id="median-house-value-plots">Median House Value Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Median House Value                                                         </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting housing value data from the 5-year 2020 American Community Survey.</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify county for just Chickasaw, Grundy, and Buchanan County.</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The API Code for median home value is "B25077_001."</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>housing_val <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"tract"</span>, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B25077_001"</span>, </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"IA"</span>, </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="fu">c</span>(<span class="st">"Chickasaw"</span>,<span class="st">"Grundy"</span>,<span class="st">"Buchanan"</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate the median home value data into three separate geographies: tract, county, and state.</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>housing_val2 <span class="ot">&lt;-</span> <span class="fu">separate</span>(</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  housing_val, </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  NAME, </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"tract"</span>, <span class="st">"county"</span>, <span class="st">"state"</span>), </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">", "</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>)  </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter median home value data by census tract. </span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co"># The city of Independence falls into two census tracts: 9505 and 9504.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Grundy Center is in tract 9603.</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co"># New Hampton is in tract 704.</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column called "city" with the associated city name. </span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>ind_house_val <span class="ot">&lt;-</span> housing_val2 <span class="sc">%&gt;%</span> </span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tract <span class="sc">==</span> <span class="fu">c</span>(<span class="st">"Census Tract 9505"</span>, <span class="st">"Census Tract 9504"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">city =</span> <span class="st">"Independence"</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>hampton_house_val <span class="ot">&lt;-</span> housing_val2 <span class="sc">%&gt;%</span> </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tract <span class="sc">==</span> <span class="st">"Census Tract 704"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">city =</span> <span class="st">"New Hampton"</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>grundy_house_val <span class="ot">&lt;-</span> housing_val2 <span class="sc">%&gt;%</span> </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tract <span class="sc">==</span> <span class="st">"Census Tract 9603"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">city =</span> <span class="st">"Grundy Center"</span>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind individual data frames together with bind_rows().</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>cities_house_val <span class="ot">&lt;-</span> ind_house_val <span class="sc">%&gt;%</span> </span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(hampton_house_val,grundy_house_val)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the summarize function to find the minimum, maximum, median and mean of the median home value estimates. </span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>cities_house_val <span class="sc">%&gt;%</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city) <span class="sc">%&gt;%</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">min =</span> <span class="fu">min</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 x 5
  city             min   mean median    max
  &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Grundy Center 135900 135900 135900 135900
2 Independence  133200 136400 136400 139600
3 New Hampton   117500 117500 117500 117500</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cannot visualize cities_house_val using this ggplot method because Grundy Center and New Hampton only have one value.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot housing value by county instead.</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add in a point that displays the median for each city from the 2020 5-Year ACS.</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>housing_val3 <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"place"</span>, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B25077_001"</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center city, Iowa"</span>,<span class="st">"New Hampton city, Iowa"</span>, <span class="st">"Independence city, Iowa"</span>))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># grundy center = $130,600</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># new hampton = $112,200</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># independence = $129,900</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a density plot for median home value.                                   PLOT</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(housing_val2, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">fill =</span> county)) <span class="sc">+</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.00002074</span>, <span class="at">x =</span> <span class="dv">112200</span>), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="co"># New Hampton</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">129900</span>, <span class="at">y =</span> .<span class="dv">00001405</span>), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="co"># Independence</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">130600</span>, <span class="at">y =</span> .<span class="dv">0000227</span>), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="co"># Grundy Center</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.00002074</span>, <span class="at">x =</span> <span class="dv">112200</span>, <span class="at">label =</span> <span class="st">"New Hampton</span><span class="sc">\n</span><span class="st">$112,200"</span>), <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">129900</span>, <span class="at">y =</span> .<span class="dv">00001405</span>, <span class="at">label =</span> <span class="st">"Independence</span><span class="sc">\n</span><span class="st">$129,900"</span>), <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">130600</span>, <span class="at">y =</span> .<span class="dv">0000227</span>, <span class="at">label =</span> <span class="st">"Grundy Center</span><span class="sc">\n</span><span class="st">$130,600"</span>), <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="sc">-</span>.<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Median House Values by Census Tract"</span>,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2016-2020 5-Year ACS Estimates"</span>,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Median House Value"</span>,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Points represent median house value for each city</span><span class="sc">\n</span><span class="st">Variable: B25077_001"</span>,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">000026</span>))<span class="sc">+</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week_8_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, want to plot all available data for median home value. </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting median home value data from the 5-Year American Community Survey. </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The median home value code is "B25077_001."</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an object called "years" that lists the years you want to pull data from. </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We want all of the years the ACS data is available. </span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">2009</span><span class="sc">:</span><span class="dv">2021</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(years) <span class="ot">&lt;-</span> years</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Use get_acs() to pull median home value data at the place level.</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>placeValue <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"median_value"</span> <span class="ot">=</span> <span class="st">"B25077_001"</span>),</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the " city, Iowa|, Iowa" from the end of the place names.</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>placeValue <span class="ot">&lt;-</span> placeValue <span class="sc">%&gt;%</span> </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa|, Iowa"</span>))</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter placeValue for desired cities.</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a geography column.</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>placeValue <span class="ot">&lt;-</span> placeValue <span class="sc">%&gt;%</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center"</span>, <span class="st">"Independence"</span>, <span class="st">"New Hampton"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"Place"</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Use get_acs() to pull median home value data at the state level.</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>stateValue <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"state"</span>,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"median_value"</span> <span class="ot">=</span> <span class="st">"B25077_001"</span>),</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) </span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a geography column. </span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>stateValue <span class="ot">&lt;-</span> stateValue <span class="sc">%&gt;%</span> </span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"State"</span>)</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Use get_acs() to pull median home value data at the regional level.</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>regionValue <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"region"</span>,</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"median_value"</span> <span class="ot">=</span> <span class="st">"B25077_001"</span>),</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) </span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the " Region" from the end of the region names</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>regionValue<span class="ot">&lt;-</span> regionValue <span class="sc">%&gt;%</span> </span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" Region"</span>))</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter regionValue for Midwest.</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a geography column.</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>regionValue <span class="ot">&lt;-</span> regionValue <span class="sc">%&gt;%</span></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">%in%</span> <span class="st">"Midwest"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"Region"</span>)</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Use get_acs() to pull median home value data at the national level.</span></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>nationValue <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"us"</span>,</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"median_value"</span> <span class="ot">=</span> <span class="st">"B25077_001"</span>),</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>)</span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a geography column.</span></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>nationValue <span class="ot">&lt;-</span> nationValue <span class="sc">%&gt;%</span> </span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geography =</span> <span class="st">"Nation"</span>)</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind all geographies together with bind_rows().</span></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> nationValue <span class="sc">%&gt;%</span> </span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(regionValue, stateValue, placeValue)</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column specifying if the geography is a nation, region, state, or place. </span></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>value <span class="ot">&lt;-</span> value <span class="sc">%&gt;%</span> </span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grouping =</span> <span class="fu">ifelse</span>(NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"Midwest"</span>, <span class="st">"Iowa"</span>), <span class="st">"Contextual Area"</span>, NAME))</span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Create three separate plots for Grundy Center, Independence and New Hampton.</span></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots together using patchwork library. </span></span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("patchwork")</span></span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the median home value for Grundy Center and its contextual geographies.       PLOT</span></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> value[value<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center"</span>, <span class="st">"United States"</span>, <span class="st">"Midwest"</span>, <span class="st">"Iowa"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> median_valueE, <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> median_valueE <span class="sc">+</span> median_valueM, <span class="at">ymin =</span> median_valueE <span class="sc">-</span> median_valueM, <span class="at">fill =</span> geography),</span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> geography), <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> .<span class="dv">001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>),</span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">85000</span>,<span class="dv">250000</span>))<span class="sc">+</span></span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2009-2021 5-Year ACS Estimates</span><span class="sc">\n</span><span class="st">Grundy Center"</span>,</span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Median Home Value"</span>)</span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the median home value for Independence and its contextual geographies.        PLOT </span></span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> value[value<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Independence"</span>, <span class="st">"United States"</span>, <span class="st">"Midwest"</span>, <span class="st">"Iowa"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> median_valueE, <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> median_valueE <span class="sc">+</span> median_valueM, <span class="at">ymin =</span> median_valueE <span class="sc">-</span> median_valueM, <span class="at">fill =</span> geography),</span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> geography), <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> .<span class="dv">001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>),</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">85000</span>,<span class="dv">250000</span>))<span class="sc">+</span></span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">Independence"</span>,</span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>)</span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the median value for New Hampton and its contextual geographies.         PLOT </span></span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> value[value<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"New Hampton"</span>, <span class="st">"United States"</span>, <span class="st">"Midwest"</span>, <span class="st">"Iowa"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> median_valueE, <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> median_valueE <span class="sc">+</span> median_valueM, <span class="at">ymin =</span> median_valueE <span class="sc">-</span> median_valueM, <span class="at">fill =</span> geography),</span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> geography), <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>()<span class="sc">+</span></span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> .<span class="dv">001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>),</span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">85000</span>,<span class="dv">250000</span>))<span class="sc">+</span></span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">New Hampton"</span>,</span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Shaded area represents margin of error around the ACS estimate</span><span class="sc">\n</span><span class="st">Variable: B25077_001"</span>)</span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots. </span></span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a>combined_plots1 <span class="ot">&lt;-</span> <span class="fu">wrap_plots</span>(plot1, plot2, plot3)</span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot just the city median home value data.                                     PLOT</span></span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a>value[value<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Grundy Center"</span>, <span class="st">"New Hampton"</span>, <span class="st">"Independence"</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> median_valueE, <span class="at">group =</span> NAME, <span class="at">fill =</span> NAME)) <span class="sc">+</span> </span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> median_valueE <span class="sc">+</span> median_valueM, <span class="at">ymin =</span> median_valueE <span class="sc">-</span> median_valueM),</span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> NAME), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb15-163"><a href="#cb15-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb15-164"><a href="#cb15-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> .<span class="dv">001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>)) <span class="sc">+</span></span>
<span id="cb15-165"><a href="#cb15-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Median Home Value"</span>,</span>
<span id="cb15-166"><a href="#cb15-166" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2009-2021 5-Year ACS Estimates"</span>,</span>
<span id="cb15-167"><a href="#cb15-167" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb15-168"><a href="#cb15-168" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ACS estimate"</span>,</span>
<span id="cb15-169"><a href="#cb15-169" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb15-170"><a href="#cb15-170" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb15-171"><a href="#cb15-171" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Shaded area represents margin of error around the ACS estimate</span><span class="sc">\n</span><span class="st">Variable: B25077_001"</span>) <span class="sc">+</span></span>
<span id="cb15-172"><a href="#cb15-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">"2021"</span>, <span class="at">y =</span><span class="dv">137100</span>, <span class="at">label =</span> <span class="st">"$137,000"</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb15-173"><a href="#cb15-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">"2021"</span>, <span class="at">y =</span> <span class="dv">133300</span>, <span class="at">label =</span> <span class="st">"$133,300"</span>), <span class="at">vjust =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb15-174"><a href="#cb15-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">"2021"</span>, <span class="at">y =</span> <span class="dv">122600</span>, <span class="at">label =</span> <span class="st">"$122,600"</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Week_8_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="housing-occupancy-plots" class="level3">
<h3 class="anchored" data-anchor-id="housing-occupancy-plots">Housing Occupancy Plots</h3>
<p>```{r}, warning = FALSE, message = FALSE} # Home Ownership, Rental, and Vacancy Rates</p>
</section>
</section>
<section id="getting-owner-occupied-data-and-total-occupied-units-from-5-year-american-community-survey." class="level1">
<h1>Getting owner occupied data and total occupied units from 5-Year American Community Survey.</h1>
</section>
<section id="using-years-object-that-was-defined-earlier." class="level1">
<h1>Using years object that was defined earlier.</h1>
<p>placeOwn &lt;- map_dfr(years, ~{ get_acs( geography = “place”, variables = c(“Owner Occupied” = “B25003_002”, “total” = “B25001_001”), state = “IA”, year = .x, survey = “acs5”, ) }, .id = “year”)</p>
</section>
<section id="create-a-new-column-for-percent-own." class="level1">
<h1>Create a new column for percent own.</h1>
<p>placeOwn &lt;- placeOwn %&gt;% group_by(year, GEOID, NAME) %&gt;% mutate(percent = estimate / first(estimate)) filter(variable != “total”)</p>
</section>
<section id="getting-renter-occupied-data-and-total-occupied-units-from-5-year-american-community-survey." class="level1">
<h1>Getting renter occupied data and total occupied units from 5-Year American Community Survey.</h1>
</section>
<section id="using-years-object-defined-earlier." class="level1">
<h1>Using years object defined earlier.</h1>
<p>placeRent &lt;- map_dfr(years, ~{ get_acs( geography = “place”, variables = c(“Renter Occupied” = “B25003_003”, “total” = “B25001_001”), state = “IA”, year = .x, survey = “acs5”, ) }, .id = “year”)</p>
</section>
<section id="add-a-new-column-for-percent-rent." class="level1">
<h1>Add a new column for percent rent.</h1>
<p>placeRent &lt;- placeRent %&gt;% group_by(year, GEOID, NAME) %&gt;% mutate(percent = estimate / first(estimate)) %&gt;% filter(variable != “total”)</p>
</section>
<section id="getting-vacant-units-and-total-units-from-5-year-acs." class="level1">
<h1>Getting vacant units and total units from 5-Year ACS.</h1>
</section>
<section id="using-years-object-defined-earlier.-1" class="level1">
<h1>Using years object defined earlier.</h1>
<p>placeVacant &lt;- map_dfr(years, ~{ get_acs( geography = “place”, state = “IA”, variables = c(“Vacant” = “B25002_003”, “total” = “B25001_001”), year = .x, survey = “acs5”, ) }, .id = “year”)</p>
</section>
<section id="create-new-column-for-vacant-percent." class="level1">
<h1>Create new column for vacant percent.</h1>
<p>placeVacant &lt;- placeVacant %&gt;% group_by(year, GEOID, NAME) %&gt;% mutate(percent = estimate / first(estimate)) %&gt;% filter(variable != “total”)</p>
</section>
<section id="combine-all-data-into-one-data-frame." class="level1">
<h1>Combine all data into one data frame.</h1>
<p>placeRate &lt;- placeOwn %&gt;% bind_rows(placeRent, placeVacant)</p>
</section>
<section id="to-simplify-the-filtering-process-from-now-on-create-an-object-for-desired-cities." class="level1">
<h1>To simplify the filtering process from now on, create an object for desired cities.</h1>
<p>target_cities &lt;- c(“Independence city, Iowa”,“New Hampton city, Iowa”, “Grundy Center city, Iowa”)</p>
</section>
<section id="filter-for-desired-cities." class="level1">
<h1>Filter for desired cities.</h1>
<p>placeRate &lt;- placeRate %&gt;% filter(NAME %in% target_cities) %&gt;% mutate(NAME = str_remove(NAME,” city, Iowa”))</p>
</section>
<section id="add-a-geography-column." class="level1">
<h1>Add a geography column.</h1>
<p>placeRate &lt;- placeRate %&gt;% mutate(geography = “Place”)</p>
<section id="state-time" class="level3">
<h3 class="anchored" data-anchor-id="state-time">STATE TIME</h3>
</section>
</section>
<section id="getting-owner-occupied-data-and-total-occupied-units-from-5-year-american-community-survey-for-iowa." class="level1">
<h1>Getting owner occupied data and total occupied units from 5-Year American Community Survey for Iowa.</h1>
</section>
<section id="using-years-object-that-was-defined-earlier.-1" class="level1">
<h1>Using years object that was defined earlier.</h1>
<p>stateOwn &lt;- map_dfr(years, ~{ get_acs( geography = “state”, variables = c(“Owner Occupied” = “B25003_002”, “total” = “B25001_001”), state = “IA”, year = .x, survey = “acs5”, ) }, .id = “year”)</p>
</section>
<section id="create-a-column-called-prc_own-for-percent-home-ownership." class="level1">
<h1>Create a column called prc_own for percent home ownership.</h1>
</section>
<section id="create-column-for-the-margin-of-error-of-prc_own." class="level1">
<h1>Create column for the margin of error of prc_own.</h1>
</section>
<section id="filter-the-data-frame-for-the-desired-cities." class="level1">
<h1>Filter the data frame for the desired cities.</h1>
<p>stateOwn &lt;- stateOwn %&gt;% group_by(year) %&gt;% mutate(percent = estimate/first(estimate)) %&gt;% filter(variable != “total”)</p>
</section>
<section id="repeat-the-process-for-renter-occupied-and-vacant-units." class="level1">
<h1>Repeat the process for Renter Occupied and Vacant Units.</h1>
<p>stateRent &lt;- map_dfr(years, ~{ get_acs( geography = “state”, variables = c(“Renter Occupied” = “B25003_003”, “total” = “B25001_001”), state = “IA”, year = .x, survey = “acs5”, ) }, .id = “year”) # Calculate percent. stateRent &lt;- stateRent %&gt;% group_by(year) %&gt;% mutate(percent = estimate/first(estimate)) %&gt;% filter(variable != “total”)</p>
</section>
<section id="vacant-units-time." class="level1">
<h1>Vacant Units time.</h1>
<p>stateVacant &lt;- map_dfr(years, ~{ get_acs( geography = “state”, variables = c(“Vacant” = “B25002_003”, “total” = “B25001_001”), state = “IA”, year = .x, survey = “acs5”, ) }, .id = “year”) # Calculate percent. stateVacant &lt;- stateVacant %&gt;% group_by(year) %&gt;% mutate(percent = estimate/first(estimate)) %&gt;% filter(variable != “total”)</p>
</section>
<section id="combine-all-rates-and-add-geography." class="level1">
<h1>Combine all rates and add geography.</h1>
<p>stateRate &lt;- stateOwn %&gt;% bind_rows(stateRent, stateVacant) %&gt;% mutate(geography = “State”)</p>
<p>place_state %&gt;% filter(variable == “Owner Occupied”) %&gt;% ggplot(aes(x = year, y = percent, group = NAME, color = NAME)) + geom_line(linewidth = 1) + geom_point(size =2, color = “black”) + scale_y_continuous(labels = scales::percent)+ theme_fivethirtyeight() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(title = “Home Ownership Rate”, caption = “Variable: B25003_002”, color = ““, subtitle =”2009-2021 5-Year ACS Estimates”)</p>
<section id="region-time" class="level4">
<h4 class="anchored" data-anchor-id="region-time">REGION TIME</h4>
</section>
</section>
<section id="getting-owner-occupied-data-and-total-occupied-units-from-5-year-american-community-survey-for-the-midwest." class="level1">
<h1>Getting owner occupied data and total occupied units from 5-Year American Community Survey for the Midwest.</h1>
</section>
<section id="using-years-object-that-was-defined-earlier.-2" class="level1">
<h1>Using years object that was defined earlier.</h1>
<p>regionOwn &lt;- map_dfr(years, ~{ get_acs( geography = “region”, variables = c(“Owner Occupied” = “B25003_002”, “total” = “B25001_001”), year = .x, survey = “acs5”, ) }, .id = “year”)</p>
</section>
<section id="calculate-percent-home-ownership-rate." class="level1">
<h1>Calculate percent home ownership rate.</h1>
<p>regionOwn &lt;- regionOwn %&gt;% group_by(year, GEOID, NAME) %&gt;% mutate(percent = estimate/first(estimate)) %&gt;% filter(variable != “total”)</p>
</section>
<section id="repeat-for-renter-occupied-data." class="level1">
<h1>Repeat for Renter Occupied data.</h1>
<p>regionRent &lt;- map_dfr(years, ~{ get_acs( geography = “region”, variables = c(“Renter Occupied” = “B25003_003”, “total” = “B25001_001”), year = .x, survey = “acs5” ) }, .id = “year”) # Calculate percent rent. regionRent &lt;- regionRent %&gt;% group_by(year, GEOID, NAME) %&gt;% mutate(percent = estimate / first(estimate)) %&gt;% filter(variable != “total”)</p>
</section>
<section id="one-last-time-for-vacant-units." class="level1">
<h1>One last time for vacant units.</h1>
<p>regionVacant &lt;- map_dfr(years, ~{ get_acs( geography = “region”, variables = c(“Vacant” = “B25002_003”, “total” = “B25001_001”), year = .x, survey = “acs5” ) }, .id = “year”) # Calculate Vacant. regionVacant &lt;- regionVacant %&gt;% group_by(year, GEOID, NAME) %&gt;% mutate(percent = estimate/ first(estimate)) %&gt;% filter(variable != “total”)</p>
</section>
<section id="combine-owner-renter-and-vacant." class="level1">
<h1>Combine owner, renter, and vacant.</h1>
<p>regionRate &lt;- regionOwn %&gt;% bind_rows(regionRent, regionVacant)</p>
</section>
<section id="to-simplify-the-filtering-process-from-now-on-create-an-object-for-desired-region" class="level1">
<h1>To simplify the filtering process from now on, create an object for desired region</h1>
<p>target_region &lt;- “Midwest Region”</p>
</section>
<section id="filter-for-midwest." class="level1">
<h1>Filter for Midwest.</h1>
</section>
<section id="drop-region." class="level1">
<h1>Drop ” Region.”</h1>
</section>
<section id="add-a-geography-column.-1" class="level1">
<h1>Add a geography column.</h1>
<p>regionRate &lt;- regionRate %&gt;% filter(NAME %in% target_region) %&gt;% mutate(NAME = str_remove(NAME, ” Region”)) %&gt;% mutate(geography = “Region”)</p>
<section id="nation-time" class="level2">
<h2 class="anchored" data-anchor-id="nation-time">NATION TIME</h2>
</section>
</section>
<section id="get-data-from-the-5-year-acs." class="level1">
<h1>Get data from the 5-Year ACS.</h1>
<p>nationRate &lt;- map_dfr(years, ~{ get_acs( geography = “us”, variables = c(“Owner Occupied” = “B25003_002”, “Renter Occupied” = “B25003_003”, “Vacant” = “B25002_003”, “total” = “B25001_001”), year = .x, survey = “acs5” ) }, .id = “year”)</p>
</section>
<section id="calculate-rates." class="level1">
<h1>Calculate rates.</h1>
</section>
<section id="add-geography." class="level1">
<h1>Add geography.</h1>
<p>nationRate &lt;- nationRate %&gt;% group_by(year) %&gt;% mutate(percent = estimate/ first(estimate)) %&gt;% filter(variable != “total”) %&gt;% mutate(geography = “Nation”)</p>
</section>
<section id="create-plots-for-home-ownership-rate-at-all-geographies." class="level1">
<h1>Create plots for home ownership rate at all geographies.</h1>
</section>
<section id="home-ownership-rate" class="level1">
<h1>HOME OWNERSHIP RATE</h1>
</section>
<section id="i-want-state-region-and-nation-in-their-own-contextrate-so-that-they-can-be-displayed-by-linetype." class="level1">
<h1>I want state, region, and nation in their own contextRate so that they can be displayed by linetype.</h1>
</section>
<section id="filter-placerate-for-variable-owner-occupied" class="level1">
<h1>Filter placeRate for variable == “Owner Occupied”</h1>
<p>filtered_placeRate &lt;- placeRate %&gt;% filter(variable == “Owner Occupied”)</p>
</section>
<section id="bind-context." class="level1">
<h1>Bind context.</h1>
<p>contextRate &lt;- stateRate %&gt;% bind_rows(regionRate, nationRate) # Filter stateRate for variable == “Owner Occupied” filtered_contextRate &lt;- contextRate %&gt;% filter(variable == “Owner Occupied”)</p>
</section>
<section id="create-the-line-plot-home-ownership-rate" class="level1">
<h1>Create the line plot: Home Ownership Rate</h1>
<p>ggplot() + geom_line(data = filtered_contextRate, aes(x = year, y = percent, group = NAME, linetype = NAME), color = “black”, linewidth = 1, alpha = .4) + geom_line(data = filtered_placeRate, aes(x = year, y = percent, group = NAME, color = NAME), linewidth = 1.75) + scale_y_continuous(labels = scales::percent, limits = c(.54,.8), breaks = c(.55,.6,.65,.7,.75,.8))+ theme_fivethirtyeight() + labs(title = “Home Ownership Rate”, subtitle = “2009-2021 5-Year ACS Estimates”, caption = “Variable: B25003_002”, color = ““, linetype =”“)</p>
</section>
<section id="create-plots-for-vacancy-rate-at-all-geographies." class="level1">
<h1>Create plots for vacancy rate at all geographies.</h1>
</section>
<section id="vacancy-rate" class="level1">
<h1>VACANCY RATE</h1>
</section>
<section id="filter-for-vacancy" class="level1">
<h1>filter for vacancy</h1>
<p>vacancy_placeRate &lt;- placeRate %&gt;% filter(variable == “Vacant”) vacancy_contextRate &lt;- contextRate %&gt;% filter(variable == “Vacant”)</p>
</section>
<section id="create-the-line-plot-vacancy-rate" class="level1">
<h1>Create the line plot: Vacancy Rate</h1>
<p>ggplot() + geom_line(data = vacancy_contextRate, aes(x = year, y = percent, group = NAME, linetype = NAME), color = “black”, linewidth = 1, alpha = .4) + geom_line(data = vacancy_placeRate, aes(x = year, y = percent, group = NAME, color = NAME), linewidth = 1.5) + scale_y_continuous(labels = scales::percent, limits = c(.0, .15), breaks = c(0, .05, .1, .15)) + labs(title = “Vacancy Rate”, subtitle = “2009-2021 5-Year ACS Estimates”, caption = “Variable: B25002_003”, color = ““, linetype =”“, x =”“, y =”“) + theme_fivethirtyeight()</p>
<pre><code>
### Reason for Vacancy Plot

```{r}, warning = FALSE, message = FALSE}
# Reason for Vacancy                                                      

placeReason &lt;- get_acs(geography = "place",
                   state = "IA",
                   year = 2021,
                   variables = c("For rent" = "B25004_002",
                                 "Rented, not occupied" = "B25004_003",
                                 "For sale" = "B25004_004",
                                 "Sold, not occupied" = "B25004_005",
                                 "Seasonal" = "B25004_006",
                                 "Migrant worker" = "B25004_007",
                                 "Other" = "B25004_008",
                                 "total" = "B25004_001"))

# Filter for desired cities.
placeReason &lt;- placeReason %&gt;% 
  filter(NAME %in% target_cities) %&gt;% 
  mutate(NAME = str_remove(NAME, " city, Iowa"))

# Turn values into percents of the total.
placeReason &lt;- placeReason %&gt;% 
  group_by(NAME) %&gt;% 
  mutate(percent = estimate / first(estimate)) %&gt;% 
  filter(variable != "total")

# Plot reason for vacancy.                                                       PLOT
placeReason %&gt;% 
  ggplot(aes(x=factor(variable, level=c("For rent","Rented, not occupied","For sale","Sold, not occupied","Seasonal","Migrant worker","Other")), y = percent, group = NAME, fill = NAME)) +
  geom_col(position = "dodge") +
  theme_fivethirtyeight()+
  scale_y_continuous(labels = scales::percent,
                     breaks = c(0,.1,.2,.3,.4)) +
  labs(title = "Reason for Vacancy",
       subtitle = "2017-2021 5-Year ACS Estimates",
       x = "",
       y = "ACS estimate",
       fill = "",
       alpha = "",
       caption = "Variables: B25004_001, B25004_002, B25004_003, B25004_004,\nB25004_005, B25004_006, B25004_007, B25004_008")+
  theme(axis.text.x=element_text(angle = 45, hjust = 1),
        plot.caption = element_text(size = 8))</code></pre>
<section id="demographic-analysis" class="level2">
<h2 class="anchored" data-anchor-id="demographic-analysis">Demographic Analysis</h2>
<p>I finished gathering data for the demographic analysis this week. The code for that is below. I made a couple of minor changes to the data from last week. I decided that I wanted to gather all American Community Survey data from all years it was available instead of just for 2021.</p>
<p>If you copied any of the code from the week before, I would suggest copy the code below. It is far more accurate to the actual demographic analysis. I will be creating a separate blog that outlines the process of conducting a demographic analysis.</p>
<section id="population-data" class="level3">
<h3 class="anchored" data-anchor-id="population-data">Population Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## starting with POPULATION data for all places in Iowa ##</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the variables before getting the data.</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The Census API code for total population for 2000 and 2010 is P001001.</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>pop00 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pop"</span> <span class="ot">=</span> <span class="st">"P001001"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>pop10 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pop"</span> <span class="ot">=</span> <span class="st">"P001001"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The API code for total population changed for 2020.</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># The Census API code for total population is P1_001N for 2020. </span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>pop20 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pop"</span> <span class="ot">=</span> <span class="st">"P1_001N"</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting 2000 total population data for the USA.</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>pop00 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">year =</span> <span class="dv">2000</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variable =</span> pop00,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2000</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting 2010 total population data for the USA.</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>pop10 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>                          <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">year =</span> <span class="dv">2010</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variable =</span> pop10,</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2010</span>)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting 2020 total population data for the USA.</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>pop20 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">year =</span> <span class="dv">2020</span>,</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variable =</span> pop20,</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">output =</span> <span class="st">"wide"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2020</span>)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind the years together using bind_rows to create data frame for national context. </span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> pop20 <span class="sc">%&gt;%</span> </span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(pop10,pop00) </span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Create anew column called prc_change.</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by "NAME" so that the calculations occur individually for each place. </span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent change is calculated by subtracting year2 from year1 and dividing by year2. </span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> pop <span class="sc">%&gt;%</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NAME) <span class="sc">%&gt;%</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prc_change =</span> <span class="fu">ifelse</span>(year <span class="sc">==</span> <span class="dv">2020</span>, (pop <span class="sc">-</span> <span class="fu">lead</span>(pop)) <span class="sc">/</span> <span class="fu">lead</span>(pop),</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(year <span class="sc">==</span> <span class="dv">2010</span>, (pop <span class="sc">-</span> <span class="fu">last</span>(pop)) <span class="sc">/</span> <span class="fu">last</span>(pop), <span class="cn">NA</span>)))</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="co"># figure out if the places are growing, shrinking, or stable</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="co"># stable = between -2 and 2</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="co"># increasing &gt; 2</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a><span class="co"># decreasing &lt; -2</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> pop <span class="sc">%&gt;%</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">change_label =</span> <span class="fu">ifelse</span>(prc_change <span class="sc">&gt;</span> .<span class="dv">02</span>, <span class="st">"Growing"</span>,</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(prc_change <span class="sc">&lt;</span> <span class="sc">-</span>.<span class="dv">02</span>, <span class="st">"Shrinking"</span>, <span class="st">"Stable"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa|, Iowa"</span>))</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="co">#rename the variables</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> pop <span class="sc">%&gt;%</span> </span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Population =</span> pop) <span class="sc">%&gt;%</span> </span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> year) <span class="sc">%&gt;%</span> </span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Percent Change"</span> <span class="ot">=</span> prc_change) <span class="sc">%&gt;%</span> </span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> change_label)</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>pop <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="at">file =</span> <span class="st">"population_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## age of residents ##</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="do">######################</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># adding to pop </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an object called "years" that lists the years you want to pull data from. </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We want all of the years the ACS data is available. </span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">2009</span><span class="sc">:</span><span class="dv">2021</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(years) <span class="ot">&lt;-</span> years</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># get the median age of all people in all places in Iowa from ACS</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>median_age <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"median_age"</span> <span class="ot">=</span> <span class="st">"B01002_001"</span>),</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa|, Iowa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2005-2009 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2006-2010 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2007-2011 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2008-2012 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2009-2013 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2010-2014 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2011-2015 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2012-2016 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2013-2017 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2014-2018 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2015-2019 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2017-2021 5-year ACS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename variables</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>median_age <span class="ot">&lt;-</span> median_age <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> year) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Median Age Estimate"</span> <span class="ot">=</span> median_ageE) <span class="sc">%&gt;%</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">moe =</span> median_ageM)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get the number of people under 18 and over 65</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># API Codes seperated by gender, so have to pull twice</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># starting with Male</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>male <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"under5"</span> <span class="ot">=</span> <span class="st">"B01001_003"</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a5to9"</span> <span class="ot">=</span> <span class="st">"B01001_004"</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a10to14"</span> <span class="ot">=</span> <span class="st">"B01001_005"</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a15to17"</span> <span class="ot">=</span> <span class="st">"B01001_006"</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a65to66"</span> <span class="ot">=</span> <span class="st">"B01001_020"</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a67to69"</span> <span class="ot">=</span> <span class="st">"B01001_021"</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a70to74"</span> <span class="ot">=</span> <span class="st">"B01001_022"</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a75to79"</span> <span class="ot">=</span> <span class="st">"B01001_023"</span>,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a80to84"</span> <span class="ot">=</span> <span class="st">"B01001_024"</span>,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"over85"</span> <span class="ot">=</span> <span class="st">"B01001_025"</span>,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"total"</span> <span class="ot">=</span> <span class="st">"B01001_002"</span>),</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa|, Iowa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2005-2009 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2006-2010 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2007-2011 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2008-2012 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2009-2013 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2010-2014 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2011-2015 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2012-2016 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2013-2017 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2014-2018 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2015-2019 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2017-2021 5-year ACS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now for Female</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>female <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"under5"</span> <span class="ot">=</span> <span class="st">"B01001_027"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a5to9"</span> <span class="ot">=</span> <span class="st">"B01001_028"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a10to14"</span> <span class="ot">=</span> <span class="st">"B01001_029"</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a15to17"</span> <span class="ot">=</span> <span class="st">"B01001_030"</span>,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a65to66"</span> <span class="ot">=</span> <span class="st">"B01001_044"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a67to69"</span> <span class="ot">=</span> <span class="st">"B01001_045"</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a70to74"</span> <span class="ot">=</span> <span class="st">"B01001_046"</span>,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a75to79"</span> <span class="ot">=</span> <span class="st">"B01001_047"</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"a80to84"</span> <span class="ot">=</span> <span class="st">"B01001_048"</span>,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"over85"</span> <span class="ot">=</span> <span class="st">"B01001_049"</span>,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"total"</span> <span class="ot">=</span> <span class="st">"B01001_026"</span>),</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa|, Iowa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2005-2009 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2006-2010 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2007-2011 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2008-2012 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2009-2013 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2010-2014 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2011-2015 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2012-2016 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2013-2017 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2014-2018 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2015-2019 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2017-2021 5-year ACS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create new columns for under18 and over 65 for both male and female</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new column for gender</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>male <span class="ot">&lt;-</span> male <span class="sc">%&gt;%</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">under18E =</span> <span class="fu">round</span>(under5E <span class="sc">+</span> a5to9E <span class="sc">+</span> a10to14E <span class="sc">+</span> a15to17E)) <span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">under18M =</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(under5M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a5to9M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a10to14M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a15to17M<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">over65E =</span> <span class="fu">round</span>(a65to66E <span class="sc">+</span> a67to69E <span class="sc">+</span> a70to74E <span class="sc">+</span> a75to79E <span class="sc">+</span> a80to84E <span class="sc">+</span> over85E)) <span class="sc">%&gt;%</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">over65M =</span>  <span class="fu">round</span>(<span class="fu">sqrt</span>(a65to66M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a67to69M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a70to74M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a75to79M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a80to84M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> over85M<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="st">"Male"</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>female <span class="ot">&lt;-</span> female <span class="sc">%&gt;%</span> </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">under18E =</span> <span class="fu">round</span>(under5E <span class="sc">+</span> a5to9E <span class="sc">+</span> a10to14E <span class="sc">+</span> a15to17E)) <span class="sc">%&gt;%</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">under18M =</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(under5M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a5to9M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a10to14M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a15to17M<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">over65E =</span> <span class="fu">round</span>(a65to66E <span class="sc">+</span> a67to69E <span class="sc">+</span> a70to74E <span class="sc">+</span> a75to79E <span class="sc">+</span> a80to84E <span class="sc">+</span> over85E)) <span class="sc">%&gt;%</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">over65M =</span>  <span class="fu">round</span>(<span class="fu">sqrt</span>(a65to66M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a67to69M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a70to74M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a75to79M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a80to84M<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> over85M<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="st">"Female"</span>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the data frames</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> female <span class="sc">%&gt;%</span> </span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(male)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate by city NAME, year, GEOID and gender</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="co"># create new columns for percent under 18 and percent over 65</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>aggregated_age <span class="ot">&lt;-</span> age <span class="sc">%&gt;%</span> </span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,GEOID, NAME, gender) <span class="sc">%&gt;%</span> </span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">summarize</span>(<span class="at">prc_under18E =</span> <span class="fu">sum</span>(under18E)<span class="sc">/</span><span class="fu">sum</span>(totalE),</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prc_under18M =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(under18M<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>(totalE)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="fu">sum</span>(under18E)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(totalM<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sum</span>(totalE)<span class="sc">^</span><span class="dv">4</span>),</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prc_over65E =</span> <span class="fu">sum</span>(over65E)<span class="sc">/</span><span class="fu">sum</span>(totalE),</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prc_over65M =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(over65M<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>(totalE)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="fu">sum</span>(over65E)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(totalM<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sum</span>(totalE)<span class="sc">^</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'GEOID', 'NAME'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add a column that states whether a place is "aged", "stable" or "young"</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using a 2% difference to gauge a stable population</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>aggregated_age <span class="ot">&lt;-</span> aggregated_age <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_label =</span> <span class="fu">ifelse</span>(prc_under18E <span class="sc">-</span> prc_over65E <span class="sc">&gt;</span> .<span class="dv">02</span>, <span class="st">"Young"</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(prc_under18E <span class="sc">-</span> prc_over65E <span class="sc">&lt;</span> <span class="sc">-</span>.<span class="dv">02</span>, <span class="st">"Aging"</span>, <span class="st">"Stable"</span>)))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># left_join aggregated_age to age</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> age <span class="sc">%&gt;%</span> </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aggregated_age, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"GEOID"</span>,<span class="st">"NAME"</span>,<span class="st">"gender"</span>))</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># rename variables</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> age <span class="sc">%&gt;%</span> </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Under 5"</span> <span class="ot">=</span> under5E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"5 to 9"</span> <span class="ot">=</span> a5to9E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"10 to 14"</span> <span class="ot">=</span> a10to14E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"15 to 17"</span> <span class="ot">=</span> a15to17E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"65 to 66"</span> <span class="ot">=</span> a65to66E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"67 to 69"</span> <span class="ot">=</span> a67to69E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"70 to 74"</span> <span class="ot">=</span> a70to74E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"75 to 79"</span> <span class="ot">=</span> a75to79E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"80 to 84"</span> <span class="ot">=</span> a80to84E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Over 85"</span> <span class="ot">=</span> over85E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Total Population Under 18"</span> <span class="ot">=</span> under18E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Total Population Over 65"</span> <span class="ot">=</span> over65E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Percent Population Under 18"</span> <span class="ot">=</span> prc_under18E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Percent Population Over 65"</span> <span class="ot">=</span> prc_over65E) <span class="sc">%&gt;%</span> </span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> age_label) <span class="sc">%&gt;%</span> </span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Under 5 moe"</span> <span class="ot">=</span> under5M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"5 to 9 moe"</span> <span class="ot">=</span> a5to9M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"10 to 14 moe"</span> <span class="ot">=</span> a10to14M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"15 to 17 moe"</span> <span class="ot">=</span> a15to17M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"65 to 66 moe"</span> <span class="ot">=</span> a65to66M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"67 to 69 moe"</span> <span class="ot">=</span> a67to69M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"70 to 74 moe"</span> <span class="ot">=</span> a70to74M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"75 to 79 moe"</span> <span class="ot">=</span> a75to79M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"80 to 84 moe"</span> <span class="ot">=</span> a80to84M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Over 85 moe"</span> <span class="ot">=</span> over85M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Total Population Under 18 moe"</span> <span class="ot">=</span> under18M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Total Population Over 65 moe"</span> <span class="ot">=</span> over65M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Percent Population Under 18 moe"</span> <span class="ot">=</span> prc_under18M) <span class="sc">%&gt;%</span> </span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Percent Population Over 65 moe"</span> <span class="ot">=</span> prc_over65M)</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a><span class="co"># create a .csv file for age data and median age data</span></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>age <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="at">file =</span> <span class="st">"age_data.csv"</span>)</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>median_age <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="at">file =</span> <span class="st">"median_age_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="housing-data" class="level3">
<h3 class="anchored" data-anchor-id="housing-data">Housing Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">## next is housing information ##</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="do">#################################</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># getting from 2021 5-Year ACS</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># total housing units = B25001_001</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># owner occupied units = B25003_002</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># total occupied units = B25002_002</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># total vacant units = B25002_003</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co"># median house value = B25077_001 </span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co"># median house age = B25035_001</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>housing <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"total_units"</span> <span class="ot">=</span> <span class="st">"B25001_001"</span>,</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"occupied_units"</span> <span class="ot">=</span> <span class="st">"B25002_002"</span>,</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"vacant_units"</span> <span class="ot">=</span> <span class="st">"B25002_003"</span>,</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"owner_occupied"</span> <span class="ot">=</span> <span class="st">"B25003_002"</span>,</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"renter_occupied"</span> <span class="ot">=</span> <span class="st">"B25003_003"</span>,</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"median_house_value"</span> <span class="ot">=</span> <span class="st">"B25077_001"</span>,</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"median_year_built"</span> <span class="ot">=</span> <span class="st">"B25035_001"</span>),</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa|, Iowa"</span>))</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a><span class="do">## ALL RATES ARE PERCENTAGES</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate home ownership, vacany, and rental rates</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>housing <span class="ot">&lt;-</span> housing <span class="sc">%&gt;%</span> </span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Home Ownership Rate Estimate"</span> <span class="ot">=</span> (owner_occupiedE <span class="sc">/</span> occupied_unitsE)) <span class="sc">%&gt;%</span>  <span class="co"># divide owner occupied by occupied units</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Home Ownership Rate moe"</span> <span class="ot">=</span> (<span class="fu">sqrt</span>((owner_occupiedM<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (occupied_unitsE<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> ((owner_occupiedE <span class="sc">*</span> occupied_unitsM)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (occupied_unitsE<span class="sc">^</span><span class="dv">4</span>)))) <span class="sc">%&gt;%</span>  <span class="co"># calculate new moe</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Rental Rate Estimate"</span> <span class="ot">=</span> (renter_occupiedE <span class="sc">/</span> occupied_unitsE)) <span class="sc">%&gt;%</span>  <span class="co"># divide renter occupied by occupied units</span></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Rental Rate moe"</span> <span class="ot">=</span> (<span class="fu">sqrt</span>((renter_occupiedM<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (occupied_unitsE<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> ((renter_occupiedE <span class="sc">*</span> occupied_unitsM)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (occupied_unitsE<span class="sc">^</span><span class="dv">4</span>)))) <span class="sc">%&gt;%</span> <span class="co"># calculate new moe</span></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Vacancy Rate Estimate"</span> <span class="ot">=</span> (vacant_unitsE <span class="sc">/</span> total_unitsE)) <span class="sc">%&gt;%</span>  <span class="co"># divide vacant units by total units</span></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Vacancy Rate moe"</span> <span class="ot">=</span> (<span class="fu">sqrt</span>((vacant_unitsM<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (total_unitsE<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> ((vacant_unitsE <span class="sc">*</span> total_unitsM)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (total_unitsE<span class="sc">^</span><span class="dv">4</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Occupancy Rate Estimate"</span> <span class="ot">=</span> (occupied_unitsE <span class="sc">/</span> total_unitsE)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Occupancy Rate moe"</span> <span class="ot">=</span> (<span class="fu">sqrt</span>(occupied_unitsM<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (total_unitsE<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> ((occupied_unitsE <span class="sc">*</span> total_unitsM<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> total_unitsE<span class="sc">^</span><span class="dv">4</span>)))<span class="co"># calculate new moe</span></span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a><span class="co"># rename variables</span></span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>housing <span class="ot">&lt;-</span> housing <span class="sc">%&gt;%</span> </span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Total Housing Units"</span> <span class="ot">=</span> total_unitsE) <span class="sc">%&gt;%</span> </span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Occupied Units"</span> <span class="ot">=</span> occupied_unitsE) <span class="sc">%&gt;%</span> </span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Owner Occupied Units"</span> <span class="ot">=</span> owner_occupiedE) <span class="sc">%&gt;%</span> </span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Renter Occupied Units"</span> <span class="ot">=</span> renter_occupiedE) <span class="sc">%&gt;%</span> </span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Median House Value"</span> <span class="ot">=</span> median_house_valueE) <span class="sc">%&gt;%</span> </span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Median Year Built"</span> <span class="ot">=</span> median_year_builtE) <span class="sc">%&gt;%</span> </span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Total Housing Units moe"</span> <span class="ot">=</span> total_unitsM) <span class="sc">%&gt;%</span> </span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Occupied Units moe"</span> <span class="ot">=</span> occupied_unitsM) <span class="sc">%&gt;%</span> </span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Owner Occupied Units moe"</span> <span class="ot">=</span> owner_occupiedM) <span class="sc">%&gt;%</span> </span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Renter Occupied Units moe"</span> <span class="ot">=</span> renter_occupiedM) <span class="sc">%&gt;%</span> </span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Median House Value moe"</span> <span class="ot">=</span> median_house_valueM) <span class="sc">%&gt;%</span> </span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Median Year Built moe"</span> <span class="ot">=</span> median_year_builtM)</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a><span class="co"># create a .csv file with housing data</span></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>housing <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="at">file =</span> <span class="st">"housing_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="taxable-properties-data" class="level3">
<h3 class="anchored" data-anchor-id="taxable-properties-data">Taxable Properties Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">## next is Taxable Property Values from Liesl ##</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="do">################################################</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">#link to data: https://data.iowa.gov/Local-Government-Finance/Taxable-Property-Values-in-Iowa-by-Tax-District-an/ig9g-pba5</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>taxable.csv <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/Kailyn Hogan/OneDrive - Iowa State University/Documents/GitHub/Housing/demographics/demographic analysis/Datasets/Taxable_Property_Values_in_Iowa_by_Tax_District_and_Year.csv"</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># City name is stored in City.Name as all caps</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co"># for census data, only the first letter is capitalized and city, Iowa is attached</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co"># need to lowercase taxable_prop_values and remove city, Iowa from housing and pop</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>taxable.csv <span class="ot">&lt;-</span> taxable.csv <span class="sc">%&gt;%</span> </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">City.Name =</span> <span class="fu">str_to_sentence</span>(City.Name)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">NAME =</span> City.Name) <span class="co">#str_to_sentence() uses regular sentence formatting where the first letter is capitalized</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>                              <span class="co"># could have also used str_to_titletext()</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregated the column based on City.Name</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="co"># function = sum to get the sum of all values</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="co"># na.rm = TRUE, means the NAs get ignored</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>aggregated_tax <span class="ot">&lt;-</span> taxable.csv <span class="sc">%&gt;%</span> </span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Assessment.Year,NAME) <span class="sc">%&gt;%</span> </span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Residential =</span> <span class="fu">sum</span>(Residential),</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">Commercial =</span> <span class="fu">sum</span>(Commercial),</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">Industrial =</span> <span class="fu">sum</span>(Industrial),</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">Ag.Land =</span> <span class="fu">sum</span>(Ag.Land),</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">Ag.Building =</span> <span class="fu">sum</span>(Ag.Building))</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="co"># rename variables </span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>aggregated_tax <span class="ot">&lt;-</span> aggregated_tax <span class="sc">%&gt;%</span> </span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> Assessment.Year)</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################################################</span></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>aggregated_tax</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a><span class="co"># holds summed values for each type of property for a city</span></span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a><span class="co"># needs further transforming for analysis</span></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a><span class="co"># could change aggregation to find the median value for each property type</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a><span class="co"># could be valuable to gather data for all years available.</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="workforce-area-characteristics-and-residential-area-characteristics-data" class="level3">
<h3 class="anchored" data-anchor-id="workforce-area-characteristics-and-residential-area-characteristics-data">Workforce Area Characteristics and Residential Area Characteristics Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">## next is RAC and WAC data from Liesl ##</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># link to data structure set: https://lehd.ces.census.gov/data/lodes/LODES8/LODESTechDoc8.0.pdf</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># interested in total number of jobs and ag related industries</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co"># C000 = total</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co"># CSN01 = ag related jobs</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="co"># WAC = how many people WORK in the city</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="co"># RAC = how many people live in the city AND have jobs</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co"># downloaded the data as .csv</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="co"># need to read in the .csv file with read.csv()</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>ia_rac.csv <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/Kailyn Hogan/OneDrive - Iowa State University/Documents/GitHub/Housing/demographics/demographic analysis/Datasets/ia_rac_S000_JT00_2020.csv"</span>)</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="co"># rename w_geocode to geocode so it can easily be combined with geography2 dataframe</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>ia_rac.csv <span class="ot">&lt;-</span> ia_rac.csv <span class="sc">%&gt;%</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">geocode =</span> h_geocode) </span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="co"># this .csv file contains the geography for the wac and rac data</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a><span class="co"># need to join to wac and rac files so we can aggregate by city</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>geography <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/Kailyn Hogan/OneDrive - Iowa State University/Documents/GitHub/Housing/demographics/demographic analysis/Datasets/ia_xwalk.csv"</span>)</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="co"># tabblk2020 = h_geocode </span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a><span class="co">#ctyname = county</span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a><span class="co">#cbsaname = metropolitan area name</span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="co">#stplc = FIPS state + FIPS Place</span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a><span class="co">#stplcname = place name</span></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a><span class="co"># reduce geography data frame to just h_geocode and NAME</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>geography2 <span class="ot">&lt;-</span> geography <span class="sc">%&gt;%</span> </span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"tabblk2020"</span>,<span class="st">"stplc"</span>,<span class="st">"stplcname"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">geocode =</span> tabblk2020) <span class="sc">%&gt;%</span> </span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">GEOID =</span> stplc) <span class="sc">%&gt;%</span> </span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(stplcname, <span class="st">" city, IA|, IA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>stplcname)</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all empty rows</span></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>geography2 <span class="ot">&lt;-</span> geography2 <span class="sc">%&gt;%</span> </span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">!=</span> <span class="st">""</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2023</span>)</span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a><span class="co"># use geography2 to assign city NAME to ia_rac.csv</span></span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>rac_data <span class="ot">&lt;-</span> ia_rac.csv <span class="sc">%&gt;%</span> </span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(geography2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"geocode"</span>))</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate by city name</span></span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a><span class="co"># have to remove h_geocode and GEOID so they don't aggregate</span></span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>rac_data <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(. <span class="sc">~</span> NAME, <span class="at">data =</span> rac_data, <span class="at">FUN =</span> sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"geocode"</span>,<span class="st">"GEOID"</span>,<span class="st">"year"</span>,<span class="st">"createdate"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2023</span>)</span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a><span class="co"># downloaded the data as .csv</span></span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a><span class="co"># need to read in the .csv file with read.csv()</span></span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>ia_wac.csv <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/Kailyn Hogan/OneDrive - Iowa State University/Documents/GitHub/Housing/demographics/demographic analysis/Datasets/ia_wac_S000_JT00_2020.csv"</span>)</span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a><span class="co"># rename w_geocode to geocode so it can easily be combined with geography2 dataframe</span></span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a>ia_wac.csv <span class="ot">&lt;-</span> ia_wac.csv <span class="sc">%&gt;%</span></span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">geocode =</span> w_geocode)</span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a><span class="co"># join to geography2 data frame</span></span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a>wac_data <span class="ot">&lt;-</span> geography2 <span class="sc">%&gt;%</span> </span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ia_wac.csv, <span class="at">by =</span> <span class="st">"geocode"</span>)</span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all empty rows</span></span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a>wac_data <span class="ot">&lt;-</span> wac_data <span class="sc">%&gt;%</span> </span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">!=</span> <span class="st">""</span>)</span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate by city name</span></span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a>wac_data <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(. <span class="sc">~</span> NAME, <span class="at">data =</span> wac_data[, <span class="sc">!</span>(<span class="fu">names</span>(wac_data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"geocode"</span>, <span class="st">"GEOID"</span>,<span class="st">"createdate"</span>))], <span class="at">FUN =</span> sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2023</span>)</span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a><span class="co"># rename variables</span></span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a>rac_data <span class="ot">&lt;-</span> rac_data <span class="sc">%&gt;%</span> </span>
<span id="cb65-72"><a href="#cb65-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Total Number of Jobs"</span> <span class="ot">=</span> C000) <span class="sc">%&gt;%</span> </span>
<span id="cb65-73"><a href="#cb65-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 11 (Agriculture, Forestry, Fishing and Hunting)"</span> <span class="ot">=</span> CNS01) <span class="sc">%&gt;%</span> </span>
<span id="cb65-74"><a href="#cb65-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 21 (Mining, Quarrying, and Oil and Gas Extraction)"</span> <span class="ot">=</span> CNS02) <span class="sc">%&gt;%</span> </span>
<span id="cb65-75"><a href="#cb65-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 22 (Utilities)"</span> <span class="ot">=</span> CNS03) <span class="sc">%&gt;%</span> </span>
<span id="cb65-76"><a href="#cb65-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 23 (Construction)"</span> <span class="ot">=</span> CNS04) <span class="sc">%&gt;%</span> </span>
<span id="cb65-77"><a href="#cb65-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 32-33 (Manufacturing)"</span> <span class="ot">=</span> CNS05) <span class="sc">%&gt;%</span> </span>
<span id="cb65-78"><a href="#cb65-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 42 (Wholesale Trade)"</span> <span class="ot">=</span> CNS06) <span class="sc">%&gt;%</span> </span>
<span id="cb65-79"><a href="#cb65-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 44-45 (Retail Trade)"</span> <span class="ot">=</span> CNS07) <span class="sc">%&gt;%</span> </span>
<span id="cb65-80"><a href="#cb65-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 48-49 (Transportation and Warehousing)"</span> <span class="ot">=</span> CNS08) <span class="sc">%&gt;%</span> </span>
<span id="cb65-81"><a href="#cb65-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 51 (Information)"</span> <span class="ot">=</span> CNS09) <span class="sc">%&gt;%</span> </span>
<span id="cb65-82"><a href="#cb65-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 52 (Finance)"</span> <span class="ot">=</span> CNS10) <span class="sc">%&gt;%</span> </span>
<span id="cb65-83"><a href="#cb65-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 53 (Reale Estate adn Rental and Leasing)"</span> <span class="ot">=</span> CNS11) <span class="sc">%&gt;%</span> </span>
<span id="cb65-84"><a href="#cb65-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 54 (Professional, Scientific, and Technical Services)"</span> <span class="ot">=</span> CNS12) <span class="sc">%&gt;%</span> </span>
<span id="cb65-85"><a href="#cb65-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 55 (Management of Comapanies and Enterprises)"</span> <span class="ot">=</span> CNS13) <span class="sc">%&gt;%</span> </span>
<span id="cb65-86"><a href="#cb65-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 56 (Administrative and Support and Waste Management and Remediation Services)"</span> <span class="ot">=</span> CNS14) <span class="sc">%&gt;%</span> </span>
<span id="cb65-87"><a href="#cb65-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 61 (Educational Services)"</span> <span class="ot">=</span> CNS15) <span class="sc">%&gt;%</span> </span>
<span id="cb65-88"><a href="#cb65-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 62 (Health Care and Social Assistance)"</span> <span class="ot">=</span> CNS16) <span class="sc">%&gt;%</span> </span>
<span id="cb65-89"><a href="#cb65-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 71 (Arts, Entertainment, and Recreation)"</span> <span class="ot">=</span> CNS17) <span class="sc">%&gt;%</span> </span>
<span id="cb65-90"><a href="#cb65-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 72 (Accomodation and Food Service)"</span> <span class="ot">=</span> CNS18) <span class="sc">%&gt;%</span> </span>
<span id="cb65-91"><a href="#cb65-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 81 (Other Serivces, except Public Administratoin)"</span> <span class="ot">=</span> CNS19) <span class="sc">%&gt;%</span> </span>
<span id="cb65-92"><a href="#cb65-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 92 (Public Administration)"</span> <span class="ot">=</span> CNS20)</span>
<span id="cb65-93"><a href="#cb65-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-94"><a href="#cb65-94" aria-hidden="true" tabindex="-1"></a>wac_data <span class="ot">&lt;-</span> wac_data <span class="sc">%&gt;%</span> </span>
<span id="cb65-95"><a href="#cb65-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Total Number of Jobs"</span> <span class="ot">=</span> C000) <span class="sc">%&gt;%</span> </span>
<span id="cb65-96"><a href="#cb65-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 11 (Agriculture, Forestry, Fishing and Hunting)"</span> <span class="ot">=</span> CNS01) <span class="sc">%&gt;%</span> </span>
<span id="cb65-97"><a href="#cb65-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 21 (Mining, Quarrying, and Oil and Gas Extraction)"</span> <span class="ot">=</span> CNS02) <span class="sc">%&gt;%</span> </span>
<span id="cb65-98"><a href="#cb65-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 22 (Utilities)"</span> <span class="ot">=</span> CNS03) <span class="sc">%&gt;%</span> </span>
<span id="cb65-99"><a href="#cb65-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 23 (Construction)"</span> <span class="ot">=</span> CNS04) <span class="sc">%&gt;%</span> </span>
<span id="cb65-100"><a href="#cb65-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 32-33 (Manufacturing)"</span> <span class="ot">=</span> CNS05) <span class="sc">%&gt;%</span> </span>
<span id="cb65-101"><a href="#cb65-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 42 (Wholesale Trade)"</span> <span class="ot">=</span> CNS06) <span class="sc">%&gt;%</span> </span>
<span id="cb65-102"><a href="#cb65-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 44-45 (Retail Trade)"</span> <span class="ot">=</span> CNS07) <span class="sc">%&gt;%</span> </span>
<span id="cb65-103"><a href="#cb65-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 48-49 (Transportation and Warehousing)"</span> <span class="ot">=</span> CNS08) <span class="sc">%&gt;%</span> </span>
<span id="cb65-104"><a href="#cb65-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 51 (Information)"</span> <span class="ot">=</span> CNS09) <span class="sc">%&gt;%</span> </span>
<span id="cb65-105"><a href="#cb65-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 52 (Finance)"</span> <span class="ot">=</span> CNS10) <span class="sc">%&gt;%</span> </span>
<span id="cb65-106"><a href="#cb65-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 53 (Reale Estate adn Rental and Leasing)"</span> <span class="ot">=</span> CNS11) <span class="sc">%&gt;%</span> </span>
<span id="cb65-107"><a href="#cb65-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 54 (Professional, Scientific, and Technical Services)"</span> <span class="ot">=</span> CNS12) <span class="sc">%&gt;%</span> </span>
<span id="cb65-108"><a href="#cb65-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 55 (Management of Comapanies and Enterprises)"</span> <span class="ot">=</span> CNS13) <span class="sc">%&gt;%</span> </span>
<span id="cb65-109"><a href="#cb65-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 56 (Administrative and Support and Waste Management and Remediation Services)"</span> <span class="ot">=</span> CNS14) <span class="sc">%&gt;%</span> </span>
<span id="cb65-110"><a href="#cb65-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 61 (Educational Services)"</span> <span class="ot">=</span> CNS15) <span class="sc">%&gt;%</span> </span>
<span id="cb65-111"><a href="#cb65-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 62 (Health Care and Social Assistance)"</span> <span class="ot">=</span> CNS16) <span class="sc">%&gt;%</span> </span>
<span id="cb65-112"><a href="#cb65-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 71 (Arts, Entertainment, and Recreation)"</span> <span class="ot">=</span> CNS17) <span class="sc">%&gt;%</span> </span>
<span id="cb65-113"><a href="#cb65-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 72 (Accomodation and Food Service)"</span> <span class="ot">=</span> CNS18) <span class="sc">%&gt;%</span> </span>
<span id="cb65-114"><a href="#cb65-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 81 (Other Serivces, except Public Administratoin)"</span> <span class="ot">=</span> CNS19) <span class="sc">%&gt;%</span> </span>
<span id="cb65-115"><a href="#cb65-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Number of Jobs in NAICS sector 92 (Public Administration)"</span> <span class="ot">=</span> CNS20)</span>
<span id="cb65-116"><a href="#cb65-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-117"><a href="#cb65-117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-118"><a href="#cb65-118" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################################################</span></span>
<span id="cb65-119"><a href="#cb65-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-120"><a href="#cb65-120" aria-hidden="true" tabindex="-1"></a><span class="co"># wac and rac data need futher transforming for analysis</span></span>
<span id="cb65-121"><a href="#cb65-121" aria-hidden="true" tabindex="-1"></a><span class="co"># should change data into percents to standardize the data and account for different population sizes</span></span>
<span id="cb65-122"><a href="#cb65-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-123"><a href="#cb65-123" aria-hidden="true" tabindex="-1"></a><span class="co"># example of transformation below</span></span>
<span id="cb65-124"><a href="#cb65-124" aria-hidden="true" tabindex="-1"></a><span class="co"># used earlier when data was held in data frame differently</span></span>
<span id="cb65-125"><a href="#cb65-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-126"><a href="#cb65-126" aria-hidden="true" tabindex="-1"></a><span class="co"># rac c000 = total employed residents</span></span>
<span id="cb65-127"><a href="#cb65-127" aria-hidden="true" tabindex="-1"></a><span class="co"># rac cns01 = total residents employed in ag</span></span>
<span id="cb65-128"><a href="#cb65-128" aria-hidden="true" tabindex="-1"></a><span class="co"># wac c000 = total jobs in city</span></span>
<span id="cb65-129"><a href="#cb65-129" aria-hidden="true" tabindex="-1"></a><span class="co"># wac cns01 = total ag jobs in city</span></span>
<span id="cb65-130"><a href="#cb65-130" aria-hidden="true" tabindex="-1"></a><span class="co">#wac_rac &lt;- wac_rac %&gt;% </span></span>
<span id="cb65-131"><a href="#cb65-131" aria-hidden="true" tabindex="-1"></a><span class="co">#  rename(total_jobs = C000.x) %&gt;% </span></span>
<span id="cb65-132"><a href="#cb65-132" aria-hidden="true" tabindex="-1"></a><span class="co">#  rename(workforce_size = C000.y) %&gt;% </span></span>
<span id="cb65-133"><a href="#cb65-133" aria-hidden="true" tabindex="-1"></a><span class="co">#  rename(workforce_ag = CNS01.y) %&gt;% </span></span>
<span id="cb65-134"><a href="#cb65-134" aria-hidden="true" tabindex="-1"></a><span class="co">#  rename(ag_jobs = CNS01.x)</span></span>
<span id="cb65-135"><a href="#cb65-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-136"><a href="#cb65-136" aria-hidden="true" tabindex="-1"></a><span class="do">## prc_workforce locally employed = wac c000.x / rac c000</span></span>
<span id="cb65-137"><a href="#cb65-137" aria-hidden="true" tabindex="-1"></a><span class="do">## prc_workforce in ag = rac cns01.y / rac c000.y</span></span>
<span id="cb65-138"><a href="#cb65-138" aria-hidden="true" tabindex="-1"></a><span class="do">## prc_jobs in ag = wac cns01.x / wac c000.x</span></span>
<span id="cb65-139"><a href="#cb65-139" aria-hidden="true" tabindex="-1"></a><span class="co">#wac_rac &lt;- wac_rac %&gt;% </span></span>
<span id="cb65-140"><a href="#cb65-140" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(prc_local = total_jobs/workforce_size) %&gt;% </span></span>
<span id="cb65-141"><a href="#cb65-141" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(prc_wrkf_ag = workforce_ag / workforce_size) %&gt;% </span></span>
<span id="cb65-142"><a href="#cb65-142" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(prc_ag_jobs = ag_jobs / total_jobs)</span></span>
<span id="cb65-143"><a href="#cb65-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-144"><a href="#cb65-144" aria-hidden="true" tabindex="-1"></a><span class="do">## prc_population in workforce = rac c000.y / pop</span></span>
<span id="cb65-145"><a href="#cb65-145" aria-hidden="true" tabindex="-1"></a><span class="co"># left_joined to iowa data frame</span></span>
<span id="cb65-146"><a href="#cb65-146" aria-hidden="true" tabindex="-1"></a><span class="co"># dividing by pop20 because wac and rac data is from 2020</span></span>
<span id="cb65-147"><a href="#cb65-147" aria-hidden="true" tabindex="-1"></a><span class="co">#iowa &lt;- iowa %&gt;% </span></span>
<span id="cb65-148"><a href="#cb65-148" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(prc_pop_in_wrkf = workforce_size / pop20) %&gt;% </span></span>
<span id="cb65-149"><a href="#cb65-149" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(prc_pop_employed = total_jobs / pop20)</span></span>
<span id="cb65-150"><a href="#cb65-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-151"><a href="#cb65-151" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################################################</span></span>
<span id="cb65-152"><a href="#cb65-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-153"><a href="#cb65-153" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new .csv file for both wac and rac data</span></span>
<span id="cb65-154"><a href="#cb65-154" aria-hidden="true" tabindex="-1"></a>rac_data <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="at">file =</span> <span class="st">"rac_data.csv"</span>)</span>
<span id="cb65-155"><a href="#cb65-155" aria-hidden="true" tabindex="-1"></a>wac_data <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="at">file =</span> <span class="st">"wac_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="employment-data" class="level3">
<h3 class="anchored" data-anchor-id="employment-data">Employment Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Unemployment ##</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="do">##################       </span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># unemployment data is separated by Age and Sex in API Codes</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pull first for male employment</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>employment_male <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"Total Labor Force"</span> <span class="ot">=</span> <span class="st">"B23001_001"</span>,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Total Labor Force, Male"</span> <span class="ot">=</span> <span class="st">"B23001_002"</span>,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"16 to 19"</span> <span class="ot">=</span> <span class="st">"B23001_003"</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"16 to 19, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_005"</span>,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"16 to 19, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_007"</span>,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"16 to 19, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_008"</span>,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"20 to 21"</span> <span class="ot">=</span> <span class="st">"B23001_010"</span>,</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"20 to 21, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_012"</span>,</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"20 to 21, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_014"</span>,</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"20 to 21, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_015"</span>,</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"22 to 24"</span> <span class="ot">=</span> <span class="st">"B23001_017"</span>,</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"22 to 24, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_019"</span>,</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"22 to 24, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_021"</span>,</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"22 to 24, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_022"</span>,</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"25 to 29"</span> <span class="ot">=</span> <span class="st">"B23001_024"</span>,</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"25 to 29, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_026"</span>,</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"25 to 29, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_028"</span>,</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"25 to 29, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_029"</span>,</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"30 to 34"</span> <span class="ot">=</span> <span class="st">"B23001_031"</span>,</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"30 to 34, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_033"</span>,</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"30 to 34, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_035"</span>,</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"30 to 34, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_036"</span>,</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"35 to 44"</span> <span class="ot">=</span> <span class="st">"B23001_038"</span>,</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"35 to 44, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_040"</span>,</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"35 to 44, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_042"</span>,</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"35 to 44, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_043"</span>,</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"45 to 54"</span> <span class="ot">=</span> <span class="st">"B23001_045"</span>,</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"45 to 54, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_047"</span>,</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"45 to 54, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_049"</span>,</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"45 to 54, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_050"</span>,</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"55 to 59"</span> <span class="ot">=</span> <span class="st">"B23001_052"</span>,</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"55 to 59, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_054"</span>,</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"55 to 59, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_056"</span>,</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"55 to 59, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_057"</span>,</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"60 to 61"</span> <span class="ot">=</span> <span class="st">"B23001_059"</span>,</span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"60 to 61, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_061"</span>,</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"60 to 61, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_063"</span>,</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"60 to 61, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_064"</span>,</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"62 to 64"</span> <span class="ot">=</span> <span class="st">"B23001_066"</span>,</span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"62 to 64, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_068"</span>,</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"62 to 64, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_070"</span>,</span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"62 to 64, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_071"</span>,</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"65 to 69"</span> <span class="ot">=</span> <span class="st">"B23001_073"</span>,</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"65 to 69, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_075"</span>,</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"65 to 69, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_076"</span>,</span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"70 to 74"</span> <span class="ot">=</span> <span class="st">"B23001_078"</span>,</span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"70 to 74, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_080"</span>,</span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"70 to 74, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_081"</span>,</span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"75 and Over"</span> <span class="ot">=</span> <span class="st">"B23001_083"</span>,</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"75 and Over, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_085"</span>,</span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"75 and Over, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_086"</span></span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="st">"Male"</span>)</span>
<span id="cb66-68"><a href="#cb66-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-69"><a href="#cb66-69" aria-hidden="true" tabindex="-1"></a>employment_male <span class="ot">&lt;-</span> employment_male <span class="sc">%&gt;%</span> </span>
<span id="cb66-70"><a href="#cb66-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa| , Iowa"</span>))</span>
<span id="cb66-71"><a href="#cb66-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-72"><a href="#cb66-72" aria-hidden="true" tabindex="-1"></a><span class="co"># now for female employment</span></span>
<span id="cb66-73"><a href="#cb66-73" aria-hidden="true" tabindex="-1"></a>employment_female <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb66-74"><a href="#cb66-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb66-75"><a href="#cb66-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb66-76"><a href="#cb66-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"Total Labor Force"</span> <span class="ot">=</span> <span class="st">"B23001_001"</span>,</span>
<span id="cb66-77"><a href="#cb66-77" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Total Labor Force, Female"</span> <span class="ot">=</span> <span class="st">"B23001_088"</span>,</span>
<span id="cb66-78"><a href="#cb66-78" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"16 to 19"</span> <span class="ot">=</span> <span class="st">"B23001_089"</span>,</span>
<span id="cb66-79"><a href="#cb66-79" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"16 to 19, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_091"</span>,</span>
<span id="cb66-80"><a href="#cb66-80" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"16 to 19, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_093"</span>,</span>
<span id="cb66-81"><a href="#cb66-81" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"16 to 19, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_094"</span>,</span>
<span id="cb66-82"><a href="#cb66-82" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"20 to 21"</span> <span class="ot">=</span> <span class="st">"B23001_096"</span>,</span>
<span id="cb66-83"><a href="#cb66-83" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"20 to 21, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_098"</span>,</span>
<span id="cb66-84"><a href="#cb66-84" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"20 to 21, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_100"</span>,</span>
<span id="cb66-85"><a href="#cb66-85" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"20 to 21, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_101"</span>,</span>
<span id="cb66-86"><a href="#cb66-86" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"22 to 24"</span> <span class="ot">=</span> <span class="st">"B23001_103"</span>,</span>
<span id="cb66-87"><a href="#cb66-87" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"22 to 24, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_105"</span>,</span>
<span id="cb66-88"><a href="#cb66-88" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"22 to 24, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_107"</span>,</span>
<span id="cb66-89"><a href="#cb66-89" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"22 to 24, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_108"</span>,</span>
<span id="cb66-90"><a href="#cb66-90" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"25 to 29"</span> <span class="ot">=</span> <span class="st">"B23001_110"</span>,</span>
<span id="cb66-91"><a href="#cb66-91" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"25 to 29, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_112"</span>,</span>
<span id="cb66-92"><a href="#cb66-92" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"25 to 29, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_114"</span>,</span>
<span id="cb66-93"><a href="#cb66-93" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"25 to 29, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_115"</span>,</span>
<span id="cb66-94"><a href="#cb66-94" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"30 to 34"</span> <span class="ot">=</span> <span class="st">"B23001_117"</span>,</span>
<span id="cb66-95"><a href="#cb66-95" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"30 to 34, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_119"</span>,</span>
<span id="cb66-96"><a href="#cb66-96" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"30 to 34, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_121"</span>,</span>
<span id="cb66-97"><a href="#cb66-97" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"30 to 34, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_122"</span>,</span>
<span id="cb66-98"><a href="#cb66-98" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"35 to 44"</span> <span class="ot">=</span> <span class="st">"B23001_124"</span>,</span>
<span id="cb66-99"><a href="#cb66-99" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"35 to 44, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_126"</span>,</span>
<span id="cb66-100"><a href="#cb66-100" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"35 to 44, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_128"</span>,</span>
<span id="cb66-101"><a href="#cb66-101" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"35 to 44, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_129"</span>,</span>
<span id="cb66-102"><a href="#cb66-102" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"45 to 54"</span> <span class="ot">=</span> <span class="st">"B23001_131"</span>,</span>
<span id="cb66-103"><a href="#cb66-103" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"45 to 54, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_133"</span>,</span>
<span id="cb66-104"><a href="#cb66-104" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"45 to 54, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_135"</span>,</span>
<span id="cb66-105"><a href="#cb66-105" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"45 to 54, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_136"</span>,</span>
<span id="cb66-106"><a href="#cb66-106" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"55 to 59"</span> <span class="ot">=</span> <span class="st">"B23001_138"</span>,</span>
<span id="cb66-107"><a href="#cb66-107" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"55 to 59, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_140"</span>,</span>
<span id="cb66-108"><a href="#cb66-108" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"55 to 59, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_142"</span>,</span>
<span id="cb66-109"><a href="#cb66-109" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"55 to 59, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_143"</span>,</span>
<span id="cb66-110"><a href="#cb66-110" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"60 to 61"</span> <span class="ot">=</span> <span class="st">"B23001_145"</span>,</span>
<span id="cb66-111"><a href="#cb66-111" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"60 to 61, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_147"</span>,</span>
<span id="cb66-112"><a href="#cb66-112" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"60 to 61, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_149"</span>,</span>
<span id="cb66-113"><a href="#cb66-113" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"60 to 61, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_150"</span>,</span>
<span id="cb66-114"><a href="#cb66-114" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"62 to 64"</span> <span class="ot">=</span> <span class="st">"B23001_152"</span>,</span>
<span id="cb66-115"><a href="#cb66-115" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"62 to 64, In Armed Forces"</span> <span class="ot">=</span> <span class="st">"B23001_154"</span>,</span>
<span id="cb66-116"><a href="#cb66-116" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"62 to 64, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_156"</span>,</span>
<span id="cb66-117"><a href="#cb66-117" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"62 to 64, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_157"</span>,</span>
<span id="cb66-118"><a href="#cb66-118" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"65 to 69"</span> <span class="ot">=</span> <span class="st">"B23001_159"</span>,</span>
<span id="cb66-119"><a href="#cb66-119" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"65 to 69, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_161"</span>,</span>
<span id="cb66-120"><a href="#cb66-120" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"65 to 69, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_162"</span>,</span>
<span id="cb66-121"><a href="#cb66-121" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"70 to 74"</span> <span class="ot">=</span> <span class="st">"B23001_164"</span>,</span>
<span id="cb66-122"><a href="#cb66-122" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"70 to 74, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_166"</span>,</span>
<span id="cb66-123"><a href="#cb66-123" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"70 to 74, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_167"</span>,</span>
<span id="cb66-124"><a href="#cb66-124" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"75 and Over"</span> <span class="ot">=</span> <span class="st">"B23001_169"</span>,</span>
<span id="cb66-125"><a href="#cb66-125" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"75 and Over, Employed"</span> <span class="ot">=</span> <span class="st">"B23001_171"</span>,</span>
<span id="cb66-126"><a href="#cb66-126" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"75 and Over, Unemployed"</span> <span class="ot">=</span> <span class="st">"B23001_172"</span></span>
<span id="cb66-127"><a href="#cb66-127" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb66-128"><a href="#cb66-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb66-129"><a href="#cb66-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb66-130"><a href="#cb66-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb66-131"><a href="#cb66-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb66-132"><a href="#cb66-132" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-133"><a href="#cb66-133" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-134"><a href="#cb66-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="st">"Female"</span>)</span>
<span id="cb66-135"><a href="#cb66-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-136"><a href="#cb66-136" aria-hidden="true" tabindex="-1"></a>employment_female <span class="ot">&lt;-</span> employment_female <span class="sc">%&gt;%</span> </span>
<span id="cb66-137"><a href="#cb66-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa| , Iowa"</span>))</span>
<span id="cb66-138"><a href="#cb66-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-139"><a href="#cb66-139" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################################################</span></span>
<span id="cb66-140"><a href="#cb66-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-141"><a href="#cb66-141" aria-hidden="true" tabindex="-1"></a>employment_female</span>
<span id="cb66-142"><a href="#cb66-142" aria-hidden="true" tabindex="-1"></a>employment_male</span>
<span id="cb66-143"><a href="#cb66-143" aria-hidden="true" tabindex="-1"></a><span class="co"># need to combine these data frames and do further transformations</span></span>
<span id="cb66-144"><a href="#cb66-144" aria-hidden="true" tabindex="-1"></a><span class="co"># should change to percents to standardize and account for different population sizes</span></span>
<span id="cb66-145"><a href="#cb66-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-146"><a href="#cb66-146" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="commuting-data" class="level3">
<h3 class="anchored" data-anchor-id="commuting-data">Commuting Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Commuting ##</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pct population traveling outside of city for work</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>travel <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"total"</span> <span class="ot">=</span> <span class="st">"B08008_001"</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"travel"</span> <span class="ot">=</span> <span class="st">"B08008_004"</span>), </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prc_travel =</span> travelE <span class="sc">/</span> totalE,</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">travel_moe =</span> (<span class="fu">moe_ratio</span>(travelE, totalE, travelM, totalM))) <span class="sc">%&gt;%</span> </span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa|, Iowa"</span>))</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a><span class="co"># rename variables </span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>travel <span class="ot">&lt;-</span> travel <span class="sc">%&gt;%</span> </span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> year) <span class="sc">%&gt;%</span> </span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Total Workforce"</span> <span class="ot">=</span> totalE) <span class="sc">%&gt;%</span> </span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Workforce Commuting"</span> <span class="ot">=</span> travelE) <span class="sc">%&gt;%</span> </span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Percent Workforce Commuting"</span> <span class="ot">=</span> prc_travel) <span class="sc">%&gt;%</span> </span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"moe"</span> <span class="ot">=</span> travel_moe) <span class="sc">%&gt;%</span> </span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Total Workforce moe"</span> <span class="ot">=</span> totalM) <span class="sc">%&gt;%</span> </span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Workforce Commuting moe"</span> <span class="ot">=</span> travelM)</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a><span class="co"># create a .csv file for travel data</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>travel <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="at">file =</span> <span class="st">"commuting_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="income-data" class="level3">
<h3 class="anchored" data-anchor-id="income-data">Income Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Income ##</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="do">############</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># median household income = B19013_001</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pct population traveling outside of city for work</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"place"</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"median_income"</span><span class="ot">=</span><span class="st">"B19013_001"</span>), </span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"IA"</span>,</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs5"</span>,</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" city, Iowa|, Iowa"</span>))</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="co"># figure out how income is changing</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate percent income change</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> income <span class="sc">%&gt;%</span> </span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NAME) <span class="sc">%&gt;%</span> </span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prc_change =</span> (median_incomeE <span class="sc">-</span> <span class="fu">lag</span>(median_incomeE)) <span class="sc">/</span> <span class="fu">lag</span>(median_incomeE)) <span class="sc">%&gt;%</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income_change_label =</span> <span class="fu">ifelse</span>(prc_change <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"Positive"</span>, <span class="st">"Negative"</span>))</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a><span class="co"># rename variables </span></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> income <span class="sc">%&gt;%</span> </span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> year) <span class="sc">%&gt;%</span> </span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Median Income"</span> <span class="ot">=</span> median_incomeE) <span class="sc">%&gt;%</span> </span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Percent Median Income Change"</span> <span class="ot">=</span> prc_change) <span class="sc">%&gt;%</span> </span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> income_change_label) <span class="sc">%&gt;%</span> </span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Median Income moe"</span> <span class="ot">=</span> median_incomeM) </span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a><span class="co"># create a .csv file for income data</span></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>income <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="at">file =</span> <span class="st">"income_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>